b_RNA_C7 <- b_RNA_C7 + facet_wrap(~Expression, scales="fixed") +
themeset + theme(axis.text.x=element_blank()) +
ggtitle("Chromatin States in Regions of Shared+Unique RNA Expression")
b_RNA_C7
b_RNA_C7 <- ggplot(data = heatmapdata_boxplot_RNA_C7_gg, aes(x=Group, y=values))+
geom_boxplot(aes(color=Group), fill=NA, outlier.shape=NA, coef=0) +
geom_point(aes(color=Group, shape=Group), size=1) +
scale_shape_manual(values=groupshapes[c(1,3,4,7)], labels=grouplabels[c(1,3,4,7)]) +
scale_color_manual(values=c(colors_fill[1], colors_fill[2], colors_fill[3], colors_fill[4]), labels=grouplabels[c(1,3,4,7)]) +
ylab("Z-Score")
b_RNA_C7 <- b_RNA_C7 + facet_wrap(~Expression, scales="fixed") +
themeset + theme(axis.text.x=element_blank()) +
ggtitle("Chromatin States in Regions of Shared+Unique RNA Expression")
b_RNA_C7
b_RNA_C7 <- ggplot(data = heatmapdata_boxplot_RNA_C7_gg, aes(x=Group, y=values))+
geom_boxplot(aes(color=Group), fill=NA, outlier.shape=NA, coef=0) +
geom_point(aes(color=Group, shape=Group), size=1) +
scale_shape_manual(values=groupshapes[c(1,3,4,7)], labels=grouplabels[c(1,3,4,7)]) +
scale_color_manual(values=c(colors_fill[1], colors_fill[2], colors_fill[3], colors_fill[4]), labels=grouplabels[c(1,3,4,7)]) +
ylab("Z-Score")
b_RNA_C7 <- b_RNA_C7 + facet_wrap(~Expression, scales="fixed") +
themeset + theme(axis.text.x=element_blank()) +
ggtitle("Chromatin States in Regions of Shared+Unique RNA Expression, CLUSTER 7")
b_RNA_C7
RNAbox_C7 <- c(ls(pattern="boxplot_"))
RNAbox_C7 <- RNAbox_C7[str_detect("C7")]
RNAbox_C7 <- RNAbox_C7[str_detect(RNAbox_C7, "C7")]
RNAbox_C7
for(i in RNAbox_C7){
expListRNA(str2lang(i))
rm(i)
}
View(listNPP5N)
View(listSUBN)
View(listSPP5SUB)
library(GenomicRanges)
library(ChIPpeakAnno)
library("EnsDb.Mmusculus.v79")
library(org.Mm.eg.db)
library(Repitools)
library(DESeq2)
library(ggplot2)
library(gplots)
library(viridis)
library(RColorBrewer)
library(uwot)
library(gtable)
library(grid)
library(ggpubr)
library(tidyverse)
rawCounts <- read.csv('CD8CountsFin.csv', header=1)
colors_fill <- c("#38F2E0", "#1A74F8", "#F262F7", "#DA0054")
sessionInfo()
library(GenomicRanges)
library(ChIPpeakAnno)
library("EnsDb.Mmusculus.v79")
library(org.Mm.eg.db)
library(Repitools)
library(DESeq2)
library(ggplot2)
library(gplots)
library(viridis)
library(RColorBrewer)
library(uwot)
library(gtable)
library(grid)
library(ggpubr)
library(tidyverse)
rawCounts <- read.csv('CD8CountsFin.csv', header=1)
colors_fill <- c("#38F2E0", "#1A74F8", "#F262F7", "#DA0054")
View(listSUBN)
View(listSUBNUp)
expList(listSUBN)
expList(str2lang(listSUBN))
comparisons
write.csv(listSUBN, file="CD8_SUBNgenelist", col.names=FALSE, row.names=TRUE, quote=FALSE)
write.csv(listSUBN, file="CD8_SUBNgenelist.csv", col.names=FALSE, row.names=TRUE, quote=FALSE)
library(GenomicRanges)
library(ChIPpeakAnno)
library("EnsDb.Mmusculus.v79")
library(org.Mm.eg.db)
library(Repitools)
library(DESeq2)
library(ggplot2)
library(gplots)
library(viridis)
library(RColorBrewer)
library(uwot)
library(gtable)
library(grid)
library(ggpubr)
library(tidyverse)
rawCounts <- read.csv('CD8CountsFin.csv', header=1)
colors_fill <- c("#38F2E0", "#1A74F8", "#F262F7", "#DA0054")
GeneList_hmcluster4 <- heatmapdata_clustered4 #%>% filter(cluster4==4)
GeneList_hmcluster4 <- GeneList_hmcluster4 %>% mutate(gene=row.names(GeneList_hmcluster4), .before=N1_a) %>% left_join(anno, by=c("gene" = "ENSEMBL")) %>% relocate(SYMBOL, .after=gene) %>% mutate(genename = coalesce(SYMBOL, gene), .after=gene) %>% select(c(genename, cluster4))
View(heatmapdata)
GeneList_hmcluster4 <- GeneList_hmcluster4 %>% mutate(gene=row.names(GeneList_hmcluster4), .before=B6N1) %>% left_join(anno, by=c("gene" = "ENSEMBL")) %>% relocate(SYMBOL, .after=gene) %>% mutate(genename = coalesce(SYMBOL, gene), .after=gene) %>% select(c(genename, cluster4))
View(heatmapdata)
GeneList_hmcluster4 <- heatmapdata_clustered4 #%>% filter(cluster4==4)
GeneList_hmcluster4 <- GeneList_hmcluster4 %>% mutate(gene=row.names(GeneList_hmcluster4), .before=B6N1) %>% select(c(genename, cluster4))
View(GeneList_hmcluster4)
GeneList_hmcluster4 <- heatmapdata_clustered4 #%>% filter(cluster4==4)
GeneList_hmcluster4 <- GeneList_hmcluster4 %>% mutate(gene=row.names(GeneList_hmcluster4), .before=B6N1) %>% select(c(gene, cluster4))
View(GeneList_hmcluster4)
write.csv(GeneList_hmcluster4, "ATAC_heatmap_genelist.csv")
heatmap.2(as.matrix(heatmapdata_clustered4[,1:(ncol(heatmapdata_clustered4)-1)]), col=plasma(n=30), main="KMeans-clustered Heatmap", trace= "none", density.info="none", key=TRUE, symkey=FALSE, keysize=1.26, key.xlab="Z-score", Colv=FALSE, Rowv=FALSE, margins=c(6,4), cexCol=1, labRow=FALSE, RowSideColors=clustercolors4, ColSideColors=heatmapgroupcolors, breaks=seq(-2, 3.5, length.out=31))
View(heatmapdata_boxplot_RNA)
View(heatmapdata_boxplot_NPPU_Up)
library(DESeq2)
library(ggplot2)
library(gplots)
library(viridis)
library(RColorBrewer)
library(uwot)
library(gtable)
library(grid)
library(ggpubr)
library(tidyverse)
#generate list of regions for heatmap
RNA_NewHeatMapClusterList <- read.csv("RNA_NewHeatMapClusterList.csv", header=1)
View(RNA_NewHeatMapClusterList)
RNA_NewHeatMapClusterList <- RNA_NewHeatMapClusterList %>% select(Cluster.4)
View(RNA_NewHeatMapClusterList)
RNA_NewHeatMapClusterList <- RNA_NewHeatMapClusterList %>% select(Cluster.4) %>% filter(!is.na())
?filter
RNA_NewHeatMapClusterList <- RNA_NewHeatMapClusterList %>% select(Cluster.4) %>% filter(!is.na(Cluster.4))
View(RNA_NewHeatMapClusterList)
RNA_NewHeatMapClusterList <- RNA_NewHeatMapClusterList[,1:362]
RNA_NewHeatMapClusterList <- RNA_NewHeatMapClusterList[1:362,]
RNA_NewHeatMapClusterList <- read.csv("RNA_NewHeatMapClusterList.csv", header=1)
RNA_NewHeatMapClusterList <- RNA_NewHeatMapClusterList %>% select(Cluster.4)
RNA_NewHeatMapClusterList <- RNA_NewHeatMapClusterList[c(1:362),]
RNA_NewHeatMapClusterList
RCD_hmgenelist <- rbind(listNPPBN %>% select(Geneid), listNPP5N %>% select(Geneid), listSPP5NPP5 %>% select(Geneid), listSPPBSUB %>% select(Geneid), listSPP5SUB %>% select(Geneid), listSPP7SUB %>% select(Geneid), listSPP7SPP5 %>% select(Geneid), listSUBN %>% select(Geneid), listSUBNPP5 %>% select(Geneid))
RCD_hmgenelist <- RCD_hmgenelist %>% distinct(Geneid, .keep_all = TRUE)
RCD_hmgenelist <- rbind(listNPPBN %>% select(Geneid), listNPP5N %>% select(Geneid), listSPP5NPP5 %>% select(Geneid), listSPPBSUB %>% select(Geneid), listSPP5SUB %>% select(Geneid), listSPP7SUB %>% select(Geneid), listSPP7SPP5 %>% select(Geneid), listSUBN %>% select(Geneid), listSUBNPP5 %>% select(Geneid))
RCD_hmgenelist <- RCD_hmgenelist %>% distinct(Geneid, .keep_all = TRUE)
RCD_hmgenelist <- RCD_hmgenelist %>% filter(gene %in% RNA_NewHeatMapClusterList)
View(RCD_hmgenelist)
RCD_hmgenelist <- RCD_hmgenelist %>% filter(Geneid %in% RNA_NewHeatMapClusterList)
View(RCD_hmgenelist)
RCD_heatmapdata <- as.data.frame(assay(rld))
RCD_heatmapdata$gene <- as.character(row.names(RCD_heatmapdata))
RCD_heatmapdata <- RCD_heatmapdata %>% dplyr::filter(gene %in% RCD_hmgenelist$Geneid)
RCD_heatmapdata <- RCD_heatmapdata %>% dplyr::select(-c(gene))
RCD_heatmapdata <- RCD_heatmapdata %>% relocate(B6NPP1_C5, .after=B6NPP2_B) %>% relocate(B6NPP3_B, .after=B6NPP2_B) %>% relocate(B6SPP2_B, .after=B6SPP1_B)  %>% relocate(B6SPP3_B, .after=B6SPP2_B) %>% relocate(B6SPP4_B, .after=B6SPP3_B) %>% relocate(B6SPP1_C5, .after=B6SPP4_B) %>% relocate(B6SPP2_C5, .after=B6SPP1_C5) %>% relocate(B6SPP3_C5, .after=B6SPP2_C5) %>% relocate(B6SPP4_C5, .after=B6SPP3_C5) %>% relocate(B6SPP1_C7, .after=B6SPP4_C5) %>% relocate(B6SPP2_C7, .after=B6SPP1_C7) %>% relocate(B6SPP3_C7, .after=B6SPP2_C7) %>% relocate(B6SPP4_C7, .after=B6SPP3_C7) %>% relocate(B6SUB1, B6SUB2, .after=B6SUB4)
RCD_heatmapdata_scaled <- t(scale(t(RCD_heatmapdata)))
heatmap.2(as.matrix(RCD_heatmapdata_clustered4[,1:(ncol(RCD_heatmapdata_clustered4)-1)]), col=plasma(n=30), main="RNA Cluster D Accessibility", trace= "none", density.info="none", key=TRUE, symkey=FALSE, keysize=1.26, key.xlab="Z-score", Colv=FALSE, Rowv=T, margins=c(6,4), cexCol=1, labRow=T, ColSideColors=heatmapgroupcolors, breaks=seq(-2, 3.5, length.out=31))
#K-Means (unfiltered)
heatmap.2(as.matrix(RCD_heatmapdata_scaled), col=plasma(n=30), main="RNA Cluster D Accessibility", trace= "none", density.info="none", key=TRUE, symkey=FALSE, keysize=1.26, key.xlab="Z-score", Colv=FALSE, Rowv=T, margins=c(6,4), cexCol=1, labRow=T, ColSideColors=heatmapgroupcolors, breaks=seq(-2, 3.5, length.out=31))
heatmap.2(as.matrix(RCD_heatmapdata_scaled), col=plasma(n=30), main="RNA Cluster D DAPs", trace= "none", density.info="none", key=TRUE, symkey=FALSE, keysize=1.26, key.xlab="Z-score", Colv=FALSE, Rowv=T, margins=c(6,4), cexCol=1, labRow=T, ColSideColors=heatmapgroupcolors, breaks=seq(-2, 3.5, length.out=31))
View(RCD_hmgenelist)
RCD_hmgenelist <- rbind(listNPPBN %>% select(Geneid), listNPP5N %>% select(Geneid), listSPP5NPP5 %>% select(Geneid), listSPPBSUB %>% select(Geneid), listSPP5SUB %>% select(Geneid), listSPP7SUB %>% select(Geneid), listSPP7SPP5 %>% select(Geneid), listSUBN %>% select(Geneid), listSUBNPP5 %>% select(Geneid))
RCD_hmgenelist <- RCD_hmgenelist %>% distinct(Geneid, .keep_all = TRUE)
View(RCD_hmgenelist)
View(CD8R_NPP5U_Down)
View(heatmapdata_boxplot_RNA)
View(RCD_hmgenelist)
RCD_hmgenelist <- RCD_hmgenelist %>% filter(str_detect(Geneid, paste(RNA_NewHeatMapClusterList, collapse="(?![:alnum:])|")))
View(RCD_hmgenelist)
RCD_heatmapdata <- as.data.frame(assay(rld))
RCD_heatmapdata$gene <- as.character(row.names(RCD_heatmapdata))
RCD_heatmapdata <- RCD_heatmapdata %>% dplyr::filter(gene %in% RCD_hmgenelist$Geneid)
RCD_heatmapdata <- RCD_heatmapdata %>% dplyr::select(-c(gene))
RCD_heatmapdata <- RCD_heatmapdata %>% relocate(B6NPP1_C5, .after=B6NPP2_B) %>% relocate(B6NPP3_B, .after=B6NPP2_B) %>% relocate(B6SPP2_B, .after=B6SPP1_B)  %>% relocate(B6SPP3_B, .after=B6SPP2_B) %>% relocate(B6SPP4_B, .after=B6SPP3_B) %>% relocate(B6SPP1_C5, .after=B6SPP4_B) %>% relocate(B6SPP2_C5, .after=B6SPP1_C5) %>% relocate(B6SPP3_C5, .after=B6SPP2_C5) %>% relocate(B6SPP4_C5, .after=B6SPP3_C5) %>% relocate(B6SPP1_C7, .after=B6SPP4_C5) %>% relocate(B6SPP2_C7, .after=B6SPP1_C7) %>% relocate(B6SPP3_C7, .after=B6SPP2_C7) %>% relocate(B6SPP4_C7, .after=B6SPP3_C7) %>% relocate(B6SUB1, B6SUB2, .after=B6SUB4)
RCD_heatmapdata_scaled <- t(scale(t(RCD_heatmapdata)))
heatmap.2(as.matrix(RCD_heatmapdata_scaled), col=plasma(n=30), main="RNA Cluster D DAPs", trace= "none", density.info="none", key=TRUE, symkey=FALSE, keysize=1.26, key.xlab="Z-score", Colv=FALSE, Rowv=T, margins=c(6,4), cexCol=1, labRow=T, ColSideColors=heatmapgroupcolors, breaks=seq(-2, 3.5, length.out=31))
RCD_heatmapdata_full <- as.data.frame(assay(rld))
RCD_heatmapdata_full$gene <- as.character(row.names(RCD_heatmapdata_full))
RCD_heatmapdata_full <- RCD_heatmapdata_full %>% dplyr::filter(str_detect(gene, paste(RNA_NewHeatMapClusterList, collapse="(?![:alnum:])|")))
RCD_heatmapdata_full <- RCD_heatmapdata_full %>% dplyr::select(-c(gene))
RCD_heatmapdata_full <- RCD_heatmapdata_full %>% relocate(B6NPP1_C5, .after=B6NPP2_B) %>% relocate(B6NPP3_B, .after=B6NPP2_B) %>% relocate(B6SPP2_B, .after=B6SPP1_B)  %>% relocate(B6SPP3_B, .after=B6SPP2_B) %>% relocate(B6SPP4_B, .after=B6SPP3_B) %>% relocate(B6SPP1_C5, .after=B6SPP4_B) %>% relocate(B6SPP2_C5, .after=B6SPP1_C5) %>% relocate(B6SPP3_C5, .after=B6SPP2_C5) %>% relocate(B6SPP4_C5, .after=B6SPP3_C5) %>% relocate(B6SPP1_C7, .after=B6SPP4_C5) %>% relocate(B6SPP2_C7, .after=B6SPP1_C7) %>% relocate(B6SPP3_C7, .after=B6SPP2_C7) %>% relocate(B6SPP4_C7, .after=B6SPP3_C7) %>% relocate(B6SUB1, B6SUB2, .after=B6SUB4)
RCD_heatmapdata_scaled_full <- t(scale(t(RCD_heatmapdata_full)))
RCD_hmclusters4 <- kmeans(RCD_heatmapdata_scaled_full, 4, iter.max=100)
RCD_heatmapdata_clustered4 <- as.data.frame(cbind(RCD_heatmapdata_scaled_full, RCD_hmclusters4$cluster)) %>% dplyr::rename("cluster4" = "V26") %>% arrange(cluster4)
RCD_heatmapdata_clustered4 <- RCD_heatmapdata_clustered4 %>% relocate(B6SUB1, B6SUB2, .after=B6SUB4)
RCD_clustercolors4 <- unlist(lapply(RCD_heatmapdata_clustered4[,'cluster4'], function(x){
for(i in 1:6){
if(x==i) return(clusterpalette[i])
}
}))
dev.off()
#K-Means (unfiltered)
heatmap.2(as.matrix(RCD_heatmapdata_clustered4[,1:(ncol(RCD_heatmapdata_clustered4)-1)]), col=plasma(n=30), main="RNA Cluster D Accessibility", trace= "none", density.info="none", key=TRUE, symkey=FALSE, keysize=1.26, key.xlab="Z-score", Colv=FALSE, Rowv=FALSE, margins=c(6,4), cexCol=1, labRow=FALSE, RowSideColors=RCD_clustercolors4, ColSideColors=heatmapgroupcolors, breaks=seq(-2, 3.5, length.out=31))
RCD_heatmapdata <- as.data.frame(assay(rld))
RCD_heatmapdata$gene <- as.character(row.names(RCD_heatmapdata))
RCD_heatmapdata <- RCD_heatmapdata %>% dplyr::filter(gene %in% RCD_hmgenelist$Geneid)
RCD_heatmapdata <- RCD_heatmapdata %>% dplyr::select(-c(gene))
RCD_heatmapdata <- RCD_heatmapdata %>% relocate(B6NPP1_C5, .after=B6NPP2_B) %>% relocate(B6NPP3_B, .after=B6NPP2_B) %>% relocate(B6SPP2_B, .after=B6SPP1_B)  %>% relocate(B6SPP3_B, .after=B6SPP2_B) %>% relocate(B6SPP4_B, .after=B6SPP3_B) %>% relocate(B6SPP1_C5, .after=B6SPP4_B) %>% relocate(B6SPP2_C5, .after=B6SPP1_C5) %>% relocate(B6SPP3_C5, .after=B6SPP2_C5) %>% relocate(B6SPP4_C5, .after=B6SPP3_C5) %>% relocate(B6SPP1_C7, .after=B6SPP4_C5) %>% relocate(B6SPP2_C7, .after=B6SPP1_C7) %>% relocate(B6SPP3_C7, .after=B6SPP2_C7) %>% relocate(B6SPP4_C7, .after=B6SPP3_C7) %>% relocate(B6SUB1, B6SUB2, .after=B6SUB4)
RCD_heatmapdata_scaled <- t(scale(t(RCD_heatmapdata)))
#format and scale expression/peak data (FULL)
RCD_heatmapdata_full <- as.data.frame(assay(rld))
RCD_heatmapdata_full$gene <- as.character(row.names(RCD_heatmapdata_full))
RCD_heatmapdata_full <- RCD_heatmapdata_full %>% dplyr::filter(str_detect(gene, paste(RNA_NewHeatMapClusterList, collapse="(?![:alnum:])|")))
RCD_heatmapdata_full <- RCD_heatmapdata_full %>% dplyr::select(-c(gene))
RCD_heatmapdata_full <- RCD_heatmapdata_full %>% relocate(B6NPP1_C5, .after=B6NPP2_B) %>% relocate(B6NPP3_B, .after=B6NPP2_B) %>% relocate(B6SPP2_B, .after=B6SPP1_B)  %>% relocate(B6SPP3_B, .after=B6SPP2_B) %>% relocate(B6SPP4_B, .after=B6SPP3_B) %>% relocate(B6SPP1_C5, .after=B6SPP4_B) %>% relocate(B6SPP2_C5, .after=B6SPP1_C5) %>% relocate(B6SPP3_C5, .after=B6SPP2_C5) %>% relocate(B6SPP4_C5, .after=B6SPP3_C5) %>% relocate(B6SPP1_C7, .after=B6SPP4_C5) %>% relocate(B6SPP2_C7, .after=B6SPP1_C7) %>% relocate(B6SPP3_C7, .after=B6SPP2_C7) %>% relocate(B6SPP4_C7, .after=B6SPP3_C7)
RCD_heatmapdata_scaled_full <- t(scale(t(RCD_heatmapdata_full)))
#K-means clustering (FULL)
RCD_hmclusters4 <- kmeans(RCD_heatmapdata_scaled_full, 4, iter.max=100)
RCD_heatmapdata_clustered4 <- as.data.frame(cbind(RCD_heatmapdata_scaled_full, RCD_hmclusters4$cluster)) %>% dplyr::rename("cluster4" = "V26") %>% arrange(cluster4)
RCD_clustercolors4 <- unlist(lapply(RCD_heatmapdata_clustered4[,'cluster4'], function(x){
for(i in 1:6){
if(x==i) return(clusterpalette[i])
}
}))
dev.off()
heatmap.2(as.matrix(RCD_heatmapdata_clustered4[,1:(ncol(RCD_heatmapdata_clustered4)-1)]), col=plasma(n=30), main="RNA Cluster D Accessibility", trace= "none", density.info="none", key=TRUE, symkey=FALSE, keysize=1.26, key.xlab="Z-score", Colv=FALSE, Rowv=FALSE, margins=c(6,4), cexCol=1, labRow=FALSE, RowSideColors=RCD_clustercolors4, ColSideColors=heatmapgroupcolors, breaks=seq(-2, 3.5, length.out=31))
heatmap.2(as.matrix(RCD_heatmapdata_scaled), col=plasma(n=30), main="RNA Cluster D DAPs", trace= "none", density.info="none", key=TRUE, symkey=FALSE, keysize=1.26, key.xlab="Z-score", Colv=FALSE, Rowv=T, margins=c(6,4), cexCol=1, labRow=T, ColSideColors=heatmapgroupcolors, breaks=seq(-2, 3.5, length.out=31))
RCD_heatmapdata <- as.data.frame(assay(rld))
RCD_heatmapdata$gene <- as.character(row.names(RCD_heatmapdata))
RCD_heatmapdata <- RCD_heatmapdata %>% dplyr::filter(gene %in% RCD_hmgenelist$Geneid)
RCD_heatmapdata <- RCD_heatmapdata %>% dplyr::select(-c(gene))
RCD_heatmapdata <- RCD_heatmapdata %>% relocate(B6NPP1_C5, .after=B6NPP2_B) %>% relocate(B6NPP3_B, .after=B6NPP2_B) %>% relocate(B6SPP2_B, .after=B6SPP1_B)  %>% relocate(B6SPP3_B, .after=B6SPP2_B) %>% relocate(B6SPP4_B, .after=B6SPP3_B) %>% relocate(B6SPP1_C5, .after=B6SPP4_B) %>% relocate(B6SPP2_C5, .after=B6SPP1_C5) %>% relocate(B6SPP3_C5, .after=B6SPP2_C5) %>% relocate(B6SPP4_C5, .after=B6SPP3_C5) %>% relocate(B6SPP1_C7, .after=B6SPP4_C5) %>% relocate(B6SPP2_C7, .after=B6SPP1_C7) %>% relocate(B6SPP3_C7, .after=B6SPP2_C7) %>% relocate(B6SPP4_C7, .after=B6SPP3_C7)
RCD_heatmapdata_scaled <- t(scale(t(RCD_heatmapdata)))
#format and scale expression/peak data (FULL)
RCD_heatmapdata_full <- as.data.frame(assay(rld))
RCD_heatmapdata_full$gene <- as.character(row.names(RCD_heatmapdata_full))
RCD_heatmapdata_full <- RCD_heatmapdata_full %>% dplyr::filter(str_detect(gene, paste(RNA_NewHeatMapClusterList, collapse="(?![:alnum:])|")))
RCD_heatmapdata_full <- RCD_heatmapdata_full %>% dplyr::select(-c(gene))
RCD_heatmapdata_full <- RCD_heatmapdata_full %>% relocate(B6NPP1_C5, .after=B6NPP2_B) %>% relocate(B6NPP3_B, .after=B6NPP2_B) %>% relocate(B6SPP2_B, .after=B6SPP1_B)  %>% relocate(B6SPP3_B, .after=B6SPP2_B) %>% relocate(B6SPP4_B, .after=B6SPP3_B) %>% relocate(B6SPP1_C5, .after=B6SPP4_B) %>% relocate(B6SPP2_C5, .after=B6SPP1_C5) %>% relocate(B6SPP3_C5, .after=B6SPP2_C5) %>% relocate(B6SPP4_C5, .after=B6SPP3_C5) %>% relocate(B6SPP1_C7, .after=B6SPP4_C5) %>% relocate(B6SPP2_C7, .after=B6SPP1_C7) %>% relocate(B6SPP3_C7, .after=B6SPP2_C7) %>% relocate(B6SPP4_C7, .after=B6SPP3_C7)
RCD_heatmapdata_scaled_full <- t(scale(t(RCD_heatmapdata_full)))
#K-means clustering (FULL)
RCD_hmclusters4 <- kmeans(RCD_heatmapdata_scaled_full, 4, iter.max=100)
RCD_heatmapdata_clustered4 <- as.data.frame(cbind(RCD_heatmapdata_scaled_full, RCD_hmclusters4$cluster)) %>% dplyr::rename("cluster4" = "V26") %>% arrange(cluster4)
RCD_clustercolors4 <- unlist(lapply(RCD_heatmapdata_clustered4[,'cluster4'], function(x){
for(i in 1:6){
if(x==i) return(clusterpalette[i])
}
}))
dev.off()
#K-Means (unfiltered)
heatmap.2(as.matrix(RCD_heatmapdata_clustered4[,1:(ncol(RCD_heatmapdata_clustered4)-1)]), col=plasma(n=30), main="RNA Cluster D Accessibility", trace= "none", density.info="none", key=TRUE, symkey=FALSE, keysize=1.26, key.xlab="Z-score", Colv=FALSE, Rowv=FALSE, margins=c(6,4), cexCol=1, labRow=FALSE, RowSideColors=RCD_clustercolors4, ColSideColors=heatmapgroupcolors, breaks=seq(-2, 3.5, length.out=31))
#K-Means (unfiltered)
heatmap.2(as.matrix(RCD_heatmapdata_scaled), col=plasma(n=30), main="RNA Cluster D DAPs", trace= "none", density.info="none", key=TRUE, symkey=FALSE, keysize=1.26, key.xlab="Z-score", Colv=FALSE, Rowv=T, margins=c(6,4), cexCol=1, labRow=T, ColSideColors=heatmapgroupcolors, breaks=seq(-2, 3.5, length.out=31))
#generate list of regions for heatmap
RNA_ClusterD_Subset <- read.csv("Pathway_Analysis_of_ClusterD_Genes.csv")
View(RNA_ClusterD_Subset)
#generate list of regions for heatmap
RNA_ClusterD_Subset <- read.csv("Pathway_Analysis_of_ClusterD_Genes.csv", header=1)
RNAList_hmgenelist <- rbind(listNPPBN %>% select(Geneid), listNPP5N %>% select(Geneid), listSPP5NPP5 %>% select(Geneid), listSPPBSUB %>% select(Geneid), listSPP5SUB %>% select(Geneid), listSPP7SUB %>% select(Geneid), listSPP7SPP5 %>% select(Geneid), listSUBN %>% select(Geneid), listSUBNPP5 %>% select(Geneid))
library(DESeq2)
library(ggplot2)
library(gplots)
library(viridis)
library(RColorBrewer)
library(uwot)
library(gtable)
library(grid)
library(ggpubr)
library(tidyverse)
RNAList_hmgenelist <- rbind(listNPPBN %>% select(Geneid), listNPP5N %>% select(Geneid), listSPP5NPP5 %>% select(Geneid), listSPPBSUB %>% select(Geneid), listSPP5SUB %>% select(Geneid), listSPP7SUB %>% select(Geneid), listSPP7SPP5 %>% select(Geneid), listSUBN %>% select(Geneid), listSUBNPP5 %>% select(Geneid))
RNAList_hmgenelist <- RNAList_hmgenelist %>% distinct(Geneid, .keep_all = TRUE)
RNAList_hmgenelist <- RNAList_hmgenelist %>% filter(str_detect(Geneid, paste(RNA_ClusterD_Subset, collapse="(?![:alnum:])|")))
RNAList_hmgenelist <- rbind(listNPPBN %>% select(Geneid), listNPP5N %>% select(Geneid), listSPP5NPP5 %>% select(Geneid), listSPPBSUB %>% select(Geneid), listSPP5SUB %>% select(Geneid), listSPP7SUB %>% select(Geneid), listSPP7SPP5 %>% select(Geneid), listSUBN %>% select(Geneid), listSUBNPP5 %>% select(Geneid))
RNAList_hmgenelist <- RNAList_hmgenelist %>% distinct(Geneid, .keep_all = TRUE)
View(RNA_ClusterD_Subset)
View(RNAList_hmgenelist)
RNAList_hmgenelist <- RNAList_hmgenelist %>% filter(str_detect(Geneid, paste(RNA_ClusterD_Subset, collapse="(?![:alnum:])|")))
View(RNAList_hmgenelist)
RNAList_hmgenelist <- rbind(listNPPBN %>% select(Geneid), listNPP5N %>% select(Geneid), listSPP5NPP5 %>% select(Geneid), listSPPBSUB %>% select(Geneid), listSPP5SUB %>% select(Geneid), listSPP7SUB %>% select(Geneid), listSPP7SPP5 %>% select(Geneid), listSUBN %>% select(Geneid), listSUBNPP5 %>% select(Geneid))
RNAList_hmgenelist <- RNAList_hmgenelist %>% distinct(Geneid, .keep_all = TRUE)
View(RNAList_hmgenelist)
RNAList_heatmapdata_full <- as.data.frame(assay(rld))
RNAList_heatmapdata_full$gene <- as.character(row.names(RNAList_heatmapdata_full))
RNAList_heatmapdata_full <- RNAList_heatmapdata_full %>% dplyr::filter(str_detect(gene, paste(RNA_ClusterD_Subset, collapse="(?![:alnum:])|")))
RNAList_heatmapdata_full <- RNAList_heatmapdata_full %>% dplyr::select(-c(gene))
RNAList_heatmapdata_full <- RNAList_heatmapdata_full %>% relocate(B6NPP1_C5, .after=B6NPP2_B) %>% relocate(B6NPP3_B, .after=B6NPP2_B) %>% relocate(B6SPP2_B, .after=B6SPP1_B)  %>% relocate(B6SPP3_B, .after=B6SPP2_B) %>% relocate(B6SPP4_B, .after=B6SPP3_B) %>% relocate(B6SPP1_C5, .after=B6SPP4_B) %>% relocate(B6SPP2_C5, .after=B6SPP1_C5) %>% relocate(B6SPP3_C5, .after=B6SPP2_C5) %>% relocate(B6SPP4_C5, .after=B6SPP3_C5) %>% relocate(B6SPP1_C7, .after=B6SPP4_C5) %>% relocate(B6SPP2_C7, .after=B6SPP1_C7) %>% relocate(B6SPP3_C7, .after=B6SPP2_C7) %>% relocate(B6SPP4_C7, .after=B6SPP3_C7)
RNAList_heatmapdata_scaled_full <- t(scale(t(RNAList_heatmapdata_full)))
RNAList_heatmapdata_full <- as.data.frame(assay(rld))
RNAList_heatmapdata_full$gene <- as.character(row.names(RNAList_heatmapdata_full))
View(RNAList_heatmapdata_full)
rm(RNA_ClusterD_Subset)
#generate list of regions for heatmap
RNAList_ClusterD_Subset <- read.csv("Pathway_Analysis_of_ClusterD_Genes.csv", header=1)
View(RNAList_ClusterD_Subset)
View(RNAList_hmgenelist)
View(RNAList_ClusterD_Subset)
RNAList_ClusterD_Subset <-  RNAList_ClusterD_Subset %>% rename("gene" = "Gene")
View(RNAList_ClusterD_Subset)
#format and scale expression/peak data (FULL)
RNAList_heatmapdata_full <- as.data.frame(assay(rld))
RNAList_heatmapdata_full$gene <- as.character(row.names(RNAList_heatmapdata_full))
RNAList_heatmapdata_full <- RNAList_heatmapdata_full %>% dplyr::filter(str_detect(gene, paste(RNA_ClusterD_Subset, collapse="(?![:alnum:])|")))
RNAList_heatmapdata_full <- RNAList_heatmapdata_full %>% dplyr::filter(str_detect(gene, paste(RNAList_ClusterD_Subset, collapse="(?![:alnum:])|")))
?paste
RNAList_heatmapdata_full <- as.data.frame(assay(rld))
RNAList_heatmapdata_full$gene <- as.character(row.names(RNAList_heatmapdata_full))
#RNAList_heatmapdata_full <- RNAList_heatmapdata_full %>% dplyr::filter(str_detect(gene, paste(RNAList_ClusterD_Subset, collapse="(?![:alnum:])|")))
RNAList_heatmapdata_full <- RNAList_heatmapdata_full %>% dplyr::filter(gene %in% RNAList_ClusterD_Subset)
#format and scale expression/peak data (FULL)
RNAList_heatmapdata_full <- as.data.frame(assay(rld))
RNAList_heatmapdata_full$gene <- as.character(row.names(RNAList_heatmapdata_full))
#RNAList_heatmapdata_full <- RNAList_heatmapdata_full %>% dplyr::filter(str_detect(gene, paste(RNAList_ClusterD_Subset, collapse="(?![:alnum:])|")))
RNAList_heatmapdata_full <- RNAList_heatmapdata_full %>% dplyr::filter(gene %in% RNAList_ClusterD_Subset)
RNAList_heatmapdata_full <- as.data.frame(assay(rld))
RNAList_heatmapdata_full$gene <- as.character(row.names(RNAList_heatmapdata_full))
View(RNAList_heatmapdata_full)
RNAList_ClusterD_Subset
#generate list of regions for heatmap
RNAList_ClusterD_Subset <- as.character(read.csv("Pathway_Analysis_of_ClusterD_Genes.csv", header=1))
#generate list of regions for heatmap
RNAList_ClusterD_Subset <- as.data.frame(read.csv("Pathway_Analysis_of_ClusterD_Genes.csv", header=1))
RNAList_ClusterD_Subset
RNAList_ClusterD_Subset$Gene
View(RNAList_ClusterD_Subset)
#format and scale expression/peak data (FULL)
RNAList_heatmapdata_full <- as.data.frame(assay(rld))
RNAList_heatmapdata_full$gene <- as.character(row.names(RNAList_heatmapdata_full))
RNAList_heatmapdata_full <- RNAList_heatmapdata_full %>% dplyr::filter(str_detect(gene, paste(RNAList_ClusterD_Subset$Gene, collapse="(?![:alnum:])|")))
#RNAList_heatmapdata_full <- RNAList_heatmapdata_full %>% dplyr::filter(gene %in% RNAList_ClusterD_Subset$Gene)
RNAList_heatmapdata_full <- RNAList_heatmapdata_full %>% dplyr::select(-c(gene))
RNAList_heatmapdata_full <- RNAList_heatmapdata_full %>% relocate(B6NPP1_C5, .after=B6NPP2_B) %>% relocate(B6NPP3_B, .after=B6NPP2_B) %>% relocate(B6SPP2_B, .after=B6SPP1_B)  %>% relocate(B6SPP3_B, .after=B6SPP2_B) %>% relocate(B6SPP4_B, .after=B6SPP3_B) %>% relocate(B6SPP1_C5, .after=B6SPP4_B) %>% relocate(B6SPP2_C5, .after=B6SPP1_C5) %>% relocate(B6SPP3_C5, .after=B6SPP2_C5) %>% relocate(B6SPP4_C5, .after=B6SPP3_C5) %>% relocate(B6SPP1_C7, .after=B6SPP4_C5) %>% relocate(B6SPP2_C7, .after=B6SPP1_C7) %>% relocate(B6SPP3_C7, .after=B6SPP2_C7) %>% relocate(B6SPP4_C7, .after=B6SPP3_C7)
RNAList_heatmapdata_scaled_full <- t(scale(t(RNAList_heatmapdata_full)))
View(RNAList_heatmapdata_scaled_full)
#K-Means (unfiltered)
heatmap.2(RNAList_heatmapdata_scaled_full, col=plasma(n=30), main="RNA Cluster D SUBSET Full", trace= "none", density.info="none", key=TRUE, symkey=FALSE, keysize=1.26, key.xlab="Z-score", Colv=FALSE, Rowv=T, margins=c(6,4), cexCol=1, labRow=T, ColSideColors=heatmapgroupcolors, breaks=seq(-2, 3.5, length.out=31))
dev.off()
#K-Means (unfiltered)
heatmap.2(RNAList_heatmapdata_scaled_full, col=plasma(n=30), main="RNA Cluster D SUBSET Full", trace= "none", density.info="none", key=TRUE, symkey=FALSE, keysize=1.26, key.xlab="Z-score", Colv=FALSE, Rowv=T, margins=c(6,4), cexCol=1, labRow=T, labCol=T ColSideColors=heatmapgroupcolors, breaks=seq(-2, 3.5, length.out=31))
#K-Means (unfiltered)
heatmap.2(RNAList_heatmapdata_scaled_full, col=plasma(n=30), main="RNA Cluster D SUBSET Full", trace= "none", density.info="none", key=TRUE, symkey=FALSE, keysize=1.26, key.xlab="Z-score", Colv=FALSE, Rowv=T, margins=c(6,4), cexCol=1, labRow=T, labCol=T ColSideColors=heatmapgroupcolors, breaks=seq(-2, 3.5, length.out=31))
#K-Means (unfiltered)
heatmap.2(RNAList_heatmapdata_scaled_full, col=plasma(n=30), main="RNA Cluster D SUBSET Full", trace= "none", density.info="none", key=TRUE, symkey=FALSE, keysize=1.26, key.xlab="Z-score", Colv=FALSE, Rowv=T, margins=c(6,4), cexCol=1, labRow=T, labCol=T, ColSideColors=heatmapgroupcolors, breaks=seq(-2, 3.5, length.out=31))
?heatmap.2
#K-Means (unfiltered)
heatmap.2(RNAList_heatmapdata_scaled_full, col=plasma(n=30), main="RNA Cluster D SUBSET Full", trace= "none", density.info="none", key=TRUE, symkey=FALSE, keysize=1.26, key.xlab="Z-score", Colv=FALSE, Rowv=T, margins=c(6,4), cexCol=1, labRow=names(RNAList_heatmapdata_scaled_full), ColSideColors=heatmapgroupcolors, breaks=seq(-2, 3.5, length.out=31))
#K-Means (unfiltered)
heatmap.2(RNAList_heatmapdata_scaled_full, col=plasma(n=30), main="RNA Cluster D SUBSET Full", trace= "none", density.info="none", key=TRUE, symkey=FALSE, keysize=1.26, key.xlab="Z-score", Colv=T, Rowv=T, margins=c(6,4), cexCol=1, labRow=names(RNAList_heatmapdata_scaled_full), ColSideColors=heatmapgroupcolors, breaks=seq(-2, 3.5, length.out=31))
#K-Means (unfiltered)
heatmap.2(RNAList_heatmapdata_scaled_full, col=plasma(n=30), main="RNA Cluster D SUBSET Full", trace= "none", density.info="none", key=TRUE, symkey=FALSE, keysize=1.26, key.xlab="Z-score", Colv=F, Rowv=T, margins=c(6,4), cexCol=1, labRow=names(RNAList_heatmapdata_scaled_full), ColSideColors=heatmapgroupcolors, breaks=seq(-2, 3.5, length.out=31))
#K-Means (unfiltered)
heatmap.2(RNAList_heatmapdata_scaled_full, col=plasma(n=30), main="RNA Cluster D SUBSET Full", trace= "none", density.info="none", key=TRUE, symkey=FALSE, keysize=1.26, key.xlab="Z-score", Colv=F, Rowv=F, margins=c(6,4), cexCol=1, labRow=names(RNAList_heatmapdata_scaled_full), ColSideColors=heatmapgroupcolors, breaks=seq(-2, 3.5, length.out=31))
#K-Means (unfiltered)
heatmap.2(RNAList_heatmapdata_scaled_full, col=plasma(n=30), main="RNA Cluster D SUBSET Full", trace= "none", density.info="none", key=TRUE, symkey=FALSE, keysize=1.26, key.xlab="Z-score", Colv=F, Rowv=T, margins=c(6,4), cexCol=1, labRow=names(RNAList_heatmapdata_scaled_full), ColSideColors=heatmapgroupcolors, breaks=seq(-2, 3.5, length.out=31))
RCD_heatmapdata_boxplot <- RCD_heatmapdata_clustered4
RCD_heatmapdata_boxplot <- RCD_heatmapdata_boxplot %>% rowwise() %>%
mutate(Naive = mean(c(B6N1, B6N2, B6N3))) %>%
mutate(NPP_B = mean(c(B6NPP1_B, B6NPP2_B, B6NPP3_B))) %>%
mutate(NPP_C5 = mean(c(B6NPP1_C5, B6NPP2_C5, B6NPP3_C5))) %>%
mutate(SUB = mean(c(B6SUB3, B6SUB4, B6SUB1, B6SUB2))) %>%
mutate(SPP_B = mean(c(B6SPP1_B, B6SPP2_B, B6SPP3_B, B6SPP4_B))) %>%
mutate(SPP_C5 = mean(c(B6SPP1_C5, B6SPP2_C5, B6SPP3_C5, B6SPP4_C5))) %>%
mutate(SPP_C7 = mean(c(B6SPP1_C7, B6SPP2_C7, B6SPP3_C7, B6SPP4_C7)))
RCD_heatmapdata_boxplot <- RCD_heatmapdata_boxplot %>% select(!contains("B6", ignore.case=FALSE)) %>% rename("Cluster" = "cluster4")
#filter+format data for boxplot
RCD_heatmapdata_boxplot_gg <- stack(RCD_heatmapdata_boxplot, -Cluster)
#filter+format data for boxplot
RCD_heatmapdata_boxplot_gg <- stack(RCD_heatmapdata_boxplot)
RCD_heatmapdata_boxplot <- RCD_heatmapdata_clustered4
RCD_heatmapdata_boxplot <- RCD_heatmapdata_boxplot %>% rowwise() %>%
mutate(Naive = mean(c(B6N1, B6N2, B6N3))) %>%
mutate(NPP_B = mean(c(B6NPP1_B, B6NPP2_B, B6NPP3_B))) %>%
mutate(NPP_C5 = mean(c(B6NPP1_C5, B6NPP2_C5, B6NPP3_C5))) %>%
mutate(SUB = mean(c(B6SUB3, B6SUB4, B6SUB1, B6SUB2))) %>%
mutate(SPP_B = mean(c(B6SPP1_B, B6SPP2_B, B6SPP3_B, B6SPP4_B))) %>%
mutate(SPP_C5 = mean(c(B6SPP1_C5, B6SPP2_C5, B6SPP3_C5, B6SPP4_C5))) %>%
mutate(SPP_C7 = mean(c(B6SPP1_C7, B6SPP2_C7, B6SPP3_C7, B6SPP4_C7)))
RCD_heatmapdata_boxplot <- RCD_heatmapdata_boxplot %>% select(!contains("B6", ignore.case=FALSE)) %>% rename("Cluster" = "cluster4")
View(RCD_heatmapdata_boxplot)
RCD_heatmapdata_boxplot <- RCD_heatmapdata_clustered4
RCD_heatmapdata_boxplot <- RCD_heatmapdata_boxplot %>% rowwise() %>%
mutate(Naive = mean(c(B6N1, B6N2, B6N3))) %>%
mutate(NPP_B = mean(c(B6NPP1_B, B6NPP2_B, B6NPP3_B))) %>%
mutate(NPP_C5 = mean(c(B6NPP1_C5, B6NPP2_C5, B6NPP3_C5))) %>%
mutate(SUB = mean(c(B6SUB3, B6SUB4, B6SUB1, B6SUB2))) %>%
mutate(SPP_B = mean(c(B6SPP1_B, B6SPP2_B, B6SPP3_B, B6SPP4_B))) %>%
mutate(SPP_C5 = mean(c(B6SPP1_C5, B6SPP2_C5, B6SPP3_C5, B6SPP4_C5))) %>%
mutate(SPP_C7 = mean(c(B6SPP1_C7, B6SPP2_C7, B6SPP3_C7, B6SPP4_C7)))
RCD_heatmapdata_boxplot <- RCD_heatmapdata_boxplot %>% select(!contains("B6", ignore.case=FALSE)) %>% select(-Cluster)
RCD_heatmapdata_boxplot <- RCD_heatmapdata_boxplot %>% select(!contains("B6", ignore.case=FALSE)) %>% select(-Cluster)
RCD_heatmapdata_boxplot <- RCD_heatmapdata_boxplot %>% select(!contains("B6", ignore.case=FALSE)) %>% select(-cluster4)
#filter+format data for boxplot
RCD_heatmapdata_boxplot_gg <- stack(RCD_heatmapdata_boxplot)
View(RCD_heatmapdata_boxplot)
?stack
heatmapdata_boxplot_Shared_Up_C7 <- heatmapdata_boxplot_RNA_C7 %>% filter(str_detect(gene, paste(CD8R_Shared_Up_C7$genename, collapse="(?![:alnum:])|")))
heatmapdata_boxplot_Shared_Up_C7 <- stack(heatmapdata_boxplot_Shared_Up_C7, -gene) %>% mutate(Expression="Shared RNA Expression, Up")
RCD_heatmapdata_boxplot <- RCD_heatmapdata_clustered4
RCD_heatmapdata_boxplot <- RCD_heatmapdata_boxplot %>% rowwise() %>%
mutate(Naive = mean(c(B6N1, B6N2, B6N3))) %>%
mutate(NPP_B = mean(c(B6NPP1_B, B6NPP2_B, B6NPP3_B))) %>%
mutate(NPP_C5 = mean(c(B6NPP1_C5, B6NPP2_C5, B6NPP3_C5))) %>%
mutate(SUB = mean(c(B6SUB3, B6SUB4, B6SUB1, B6SUB2))) %>%
mutate(SPP_B = mean(c(B6SPP1_B, B6SPP2_B, B6SPP3_B, B6SPP4_B))) %>%
mutate(SPP_C5 = mean(c(B6SPP1_C5, B6SPP2_C5, B6SPP3_C5, B6SPP4_C5))) %>%
mutate(SPP_C7 = mean(c(B6SPP1_C7, B6SPP2_C7, B6SPP3_C7, B6SPP4_C7)))
RCD_heatmapdata_boxplot <- RCD_heatmapdata_boxplot %>% select(!contains("B6", ignore.case=FALSE)) %>% rename("Cluster" = "cluster4")
#filter+format data for boxplot
RCD_heatmapdata_boxplot_gg <- stack(RCD_heatmapdata_boxplot, -Cluster)
#filter+format data for boxplot
RCD_heatmapdata_boxplot <- stack(RCD_heatmapdata_boxplot, -Cluster)
RCD_heatmapdata_boxplot <- RCD_heatmapdata_clustered4
RCD_heatmapdata_boxplot <- RCD_heatmapdata_boxplot %>% rowwise() %>%
mutate(Naive = mean(c(B6N1, B6N2, B6N3))) %>%
mutate(NPP_B = mean(c(B6NPP1_B, B6NPP2_B, B6NPP3_B))) %>%
mutate(NPP_C5 = mean(c(B6NPP1_C5, B6NPP2_C5, B6NPP3_C5))) %>%
mutate(SUB = mean(c(B6SUB3, B6SUB4, B6SUB1, B6SUB2))) %>%
mutate(SPP_B = mean(c(B6SPP1_B, B6SPP2_B, B6SPP3_B, B6SPP4_B))) %>%
mutate(SPP_C5 = mean(c(B6SPP1_C5, B6SPP2_C5, B6SPP3_C5, B6SPP4_C5))) %>%
mutate(SPP_C7 = mean(c(B6SPP1_C7, B6SPP2_C7, B6SPP3_C7, B6SPP4_C7)))
RCD_heatmapdata_boxplot <- as.data.frame(RCD_heatmapdata_boxplot) %>% select(!contains("B6", ignore.case=FALSE)) %>% rename("Cluster" = "cluster4")
#filter+format data for boxplot
RCD_heatmapdata_boxplot <- stack(RCD_heatmapdata_boxplot, -Cluster)
View(RCD_heatmapdata_boxplot)
write.csv(heatmapdata_boxplot_gg, file=paste("ATAC_RNAClduterD_boxplotData.csv", sep=""), col.names=FALSE, row.names=TRUE, quote=FALSE)
b <- ggplot(data = RCD_heatmapdata_boxplot, aes(x=Group, y=values))+
geom_boxplot(aes(color=Group), fill=NA, outlier.shape=NA, coef=0) +
geom_point(aes(color=Group, shape=Group), size=1) +
scale_shape_manual(values=groupshapes, labels=grouplabels) +
scale_color_manual(values=c(colors_fill[1], alpha(colors_fill[2], 0.4), colors_fill[2], colors_fill[3], alpha(colors_fill[4], 0.55), rep(colors_fill[4], 2)), labels=grouplabels) +
ylab("Z-Score")
b + themeset
b <- ggplot(data = RCD_heatmapdata_boxplot, aes(x=ind, y=values))+
geom_boxplot(aes(color=Group), fill=NA, outlier.shape=NA, coef=0) +
geom_point(aes(color=Group, shape=Group), size=1) +
scale_shape_manual(values=groupshapes, labels=grouplabels) +
scale_color_manual(values=c(colors_fill[1], alpha(colors_fill[2], 0.4), colors_fill[2], colors_fill[3], alpha(colors_fill[4], 0.55), rep(colors_fill[4], 2)), labels=grouplabels) +
ylab("Z-Score")
b + themeset
RCD_heatmapdata_boxplot <- RCD_heatmapdata_boxplot %>% rename("Group"="ind")
b <- ggplot(data = RCD_heatmapdata_boxplot, aes(x=Group, y=values))+
geom_boxplot(aes(color=Group), fill=NA, outlier.shape=NA, coef=0) +
geom_point(aes(color=Group, shape=Group), size=1) +
scale_shape_manual(values=groupshapes, labels=grouplabels) +
scale_color_manual(values=c(colors_fill[1], alpha(colors_fill[2], 0.4), colors_fill[2], colors_fill[3], alpha(colors_fill[4], 0.55), rep(colors_fill[4], 2)), labels=grouplabels) +
ylab("Z-Score")
b + themeset
RCD_heatmapdata_boxplot <- RCD_heatmapdata_clustered4
RCD_heatmapdata_boxplot <- RCD_heatmapdata_boxplot %>% rowwise() %>%
mutate(Naive = mean(c(B6N1, B6N2, B6N3))) %>%
mutate(NPP_B = mean(c(B6NPP1_B, B6NPP2_B, B6NPP3_B))) %>%
mutate(NPP_C5 = mean(c(B6NPP1_C5, B6NPP2_C5, B6NPP3_C5))) %>%
mutate(SUB = mean(c(B6SUB3, B6SUB4, B6SUB1, B6SUB2))) %>%
mutate(SPP_B = mean(c(B6SPP1_B, B6SPP2_B, B6SPP3_B, B6SPP4_B))) %>%
mutate(SPP_C5 = mean(c(B6SPP1_C5, B6SPP2_C5, B6SPP3_C5, B6SPP4_C5))) %>%
mutate(SPP_C7 = mean(c(B6SPP1_C7, B6SPP2_C7, B6SPP3_C7, B6SPP4_C7)))
RCD_heatmapdata_boxplot <- as.data.frame(RCD_heatmapdata_boxplot) %>% select(!contains("B6", ignore.case=FALSE)) %>% rename("Cluster" = "cluster4")
#filter+format data for boxplot
RCD_heatmapdata_boxplot <- stack(RCD_heatmapdata_boxplot)
RCD_heatmapdata_boxplot <- RCD_heatmapdata_boxplot %>% rename("Group"="ind")
write.csv(heatmapdata_boxplot_gg, file=paste("ATAC_RNAClduterD_boxplotData.csv", sep=""), col.names=FALSE, row.names=TRUE, quote=FALSE)
b <- ggplot(data = RCD_heatmapdata_boxplot, aes(x=Group, y=values))+
geom_boxplot(aes(color=Group), fill=NA, outlier.shape=NA, coef=0) +
geom_point(aes(color=Group, shape=Group), size=1) +
scale_shape_manual(values=groupshapes, labels=grouplabels) +
scale_color_manual(values=c(colors_fill[1], alpha(colors_fill[2], 0.4), colors_fill[2], colors_fill[3], alpha(colors_fill[4], 0.55), rep(colors_fill[4], 2)), labels=grouplabels) +
ylab("Z-Score")
b + themeset + facet_wrap( ~ Cluster, scales="free")
View(RCD_heatmapdata_boxplot)
RCD_heatmapdata_boxplot <- RCD_heatmapdata_clustered4
RCD_heatmapdata_boxplot <- RCD_heatmapdata_boxplot %>% rowwise() %>%
mutate(Naive = mean(c(B6N1, B6N2, B6N3))) %>%
mutate(NPP_B = mean(c(B6NPP1_B, B6NPP2_B, B6NPP3_B))) %>%
mutate(NPP_C5 = mean(c(B6NPP1_C5, B6NPP2_C5, B6NPP3_C5))) %>%
mutate(SUB = mean(c(B6SUB3, B6SUB4, B6SUB1, B6SUB2))) %>%
mutate(SPP_B = mean(c(B6SPP1_B, B6SPP2_B, B6SPP3_B, B6SPP4_B))) %>%
mutate(SPP_C5 = mean(c(B6SPP1_C5, B6SPP2_C5, B6SPP3_C5, B6SPP4_C5))) %>%
mutate(SPP_C7 = mean(c(B6SPP1_C7, B6SPP2_C7, B6SPP3_C7, B6SPP4_C7)))
RCD_heatmapdata_boxplot <- as.data.frame(RCD_heatmapdata_boxplot) %>% select(!contains("B6", ignore.case=FALSE)) %>% rename("Cluster" = "cluster4")
#filter+format data for boxplot
RCD_heatmapdata_boxplot <- stack(RCD_heatmapdata_boxplot, -Cluster)
RCD_heatmapdata_boxplot <- RCD_heatmapdata_boxplot %>% rename("Group"="ind")
write.csv(heatmapdata_boxplot_gg, file=paste("ATAC_RNAClduterD_boxplotData.csv", sep=""), col.names=FALSE, row.names=TRUE, quote=FALSE)
b <- ggplot(data = RCD_heatmapdata_boxplot, aes(x=Group, y=values))+
geom_boxplot(aes(color=Group), fill=NA, outlier.shape=NA, coef=0) +
geom_point(aes(color=Group, shape=Group), size=1) +
scale_shape_manual(values=groupshapes, labels=grouplabels) +
scale_color_manual(values=c(colors_fill[1], alpha(colors_fill[2], 0.4), colors_fill[2], colors_fill[3], alpha(colors_fill[4], 0.55), rep(colors_fill[4], 2)), labels=grouplabels) +
ylab("Z-Score")
b + themeset
RNAList_heatmapdata_boxplot <- RNAList_heatmapdata_scaled_full
RNAList_heatmapdata_boxplot <- RNAList_heatmapdata_boxplot %>% rowwise() %>%
mutate(Naive = mean(c(B6N1, B6N2, B6N3))) %>%
mutate(NPP_B = mean(c(B6NPP1_B, B6NPP2_B, B6NPP3_B))) %>%
mutate(NPP_C5 = mean(c(B6NPP1_C5, B6NPP2_C5, B6NPP3_C5))) %>%
mutate(SUB = mean(c(B6SUB3, B6SUB4, B6SUB1, B6SUB2))) %>%
mutate(SPP_B = mean(c(B6SPP1_B, B6SPP2_B, B6SPP3_B, B6SPP4_B))) %>%
mutate(SPP_C5 = mean(c(B6SPP1_C5, B6SPP2_C5, B6SPP3_C5, B6SPP4_C5))) %>%
mutate(SPP_C7 = mean(c(B6SPP1_C7, B6SPP2_C7, B6SPP3_C7, B6SPP4_C7)))
RNAList_heatmapdata_boxplot <- RNAList_heatmapdata_scaled_full
RNAList_heatmapdata_boxplot <- RNAList_heatmapdata_boxplot %>% rowwise() %>%
mutate(Naive = mean(c(B6N1, B6N2, B6N3))) %>%
mutate(NPP_B = mean(c(B6NPP1_B, B6NPP2_B, B6NPP3_B))) %>%
mutate(NPP_C5 = mean(c(B6NPP1_C5, B6NPP2_C5, B6NPP3_C5))) %>%
mutate(SUB = mean(c(B6SUB3, B6SUB4, B6SUB1, B6SUB2))) %>%
mutate(SPP_B = mean(c(B6SPP1_B, B6SPP2_B, B6SPP3_B, B6SPP4_B))) %>%
mutate(SPP_C5 = mean(c(B6SPP1_C5, B6SPP2_C5, B6SPP3_C5, B6SPP4_C5))) %>%
mutate(SPP_C7 = mean(c(B6SPP1_C7, B6SPP2_C7, B6SPP3_C7, B6SPP4_C7)))
RNAList_heatmapdata_boxplot <- as.data.frame(RNAList_heatmapdata_scaled_full)
RNAList_heatmapdata_boxplot <- RNAList_heatmapdata_boxplot %>% rowwise() %>%
mutate(Naive = mean(c(B6N1, B6N2, B6N3))) %>%
mutate(NPP_B = mean(c(B6NPP1_B, B6NPP2_B, B6NPP3_B))) %>%
mutate(NPP_C5 = mean(c(B6NPP1_C5, B6NPP2_C5, B6NPP3_C5))) %>%
mutate(SUB = mean(c(B6SUB3, B6SUB4, B6SUB1, B6SUB2))) %>%
mutate(SPP_B = mean(c(B6SPP1_B, B6SPP2_B, B6SPP3_B, B6SPP4_B))) %>%
mutate(SPP_C5 = mean(c(B6SPP1_C5, B6SPP2_C5, B6SPP3_C5, B6SPP4_C5))) %>%
mutate(SPP_C7 = mean(c(B6SPP1_C7, B6SPP2_C7, B6SPP3_C7, B6SPP4_C7)))
RNAList_heatmapdata_boxplot <- as.data.frame(RNAList_heatmapdata_boxplot) %>% select(!contains("B6", ignore.case=FALSE)) %>% rename("Cluster" = "cluster4")
RNAList_heatmapdata_boxplot <- as.data.frame(RNAList_heatmapdata_boxplot) %>% select(!contains("B6", ignore.case=FALSE))
#filter+format data for boxplot
RNAList_heatmapdata_boxplot <- stack(RNAList_heatmapdata_boxplot)
RNAList_heatmapdata_boxplot <- RNAList_heatmapdata_boxplot %>% rename("Group"="ind")
View(RNAList_heatmapdata_boxplot)
write.csv(heatmapdata_boxplot_gg, file=paste("ATAC_RNAClduterDSubset_boxplotData.csv", sep=""), col.names=FALSE, row.names=TRUE, quote=FALSE)
b <- ggplot(data = RNAList_heatmapdata_boxplot, aes(x=Group, y=values))+
geom_boxplot(aes(color=Group), fill=NA, outlier.shape=NA, coef=0) +
geom_point(aes(color=Group, shape=Group), size=1) +
scale_shape_manual(values=groupshapes, labels=grouplabels) +
scale_color_manual(values=c(colors_fill[1], alpha(colors_fill[2], 0.4), colors_fill[2], colors_fill[3], alpha(colors_fill[4], 0.55), rep(colors_fill[4], 2)), labels=grouplabels) +
ylab("Z-Score")
b + themeset
