ylab("log10(S+P C5 vs. S Change Metric)") +
xlim(-4,4) +
ylim(-4,4) +
geom_abline() +
geom_hline(yintercept=0, linetype="dotted") +
geom_vline(xintercept=0, linetype="dotted") +
geom_label_repel(data=volcano_SPP5NPP5Shared[which(volcano_SPP5NPP5Shared$highlight==TRUE),], aes(label=genename.x), size=2, force=3.6)
dp_SPP5NPP5_Shared + themeset
dp_SPP5NPP5_Shared <- ggplot(data=volcano_SPP5NPP5Shared,
aes(x=(log10(abs(`NPP5N_Change Metric`)))*(`NPP5N_Change Metric`/abs(`NPP5N_Change Metric`)),
y=(log10(abs(`SPP5SUB_Change Metric`)))*(`SPP5SUB_Change Metric`/abs(`SPP5SUB_Change Metric`)))) +
geom_point(aes(color=color, size=color)) +
scale_colour_manual(values=rev(c("purple2", colors_fill[2], colors_fill[4]))) +
scale_size_manual(values=rev(c(2, 1, 1))) +
xlab("log10(N+P C5 vs. N Change Metric)") +
ylab("log10(S+P C5 vs. S Change Metric)") +
xlim(-4,4) +
ylim(-4,4) +
geom_abline() +
geom_hline(yintercept=0, linetype="dotted") +
geom_vline(xintercept=0, linetype="dotted") +
geom_label_repel(data=volcano_SPP5NPP5Shared[which(volcano_SPP5NPP5Shared$highlight==TRUE),], aes(label=genename.x), size=2, force=3.6, nudge_x = -3)
dp_SPP5NPP5_Shared + themeset
dp_SPP5NPP5_Shared <- ggplot(data=volcano_SPP5NPP5Shared,
aes(x=(log10(abs(`NPP5N_Change Metric`)))*(`NPP5N_Change Metric`/abs(`NPP5N_Change Metric`)),
y=(log10(abs(`SPP5SUB_Change Metric`)))*(`SPP5SUB_Change Metric`/abs(`SPP5SUB_Change Metric`)))) +
geom_point(aes(color=color, size=color)) +
scale_colour_manual(values=rev(c("purple2", colors_fill[2], colors_fill[4]))) +
scale_size_manual(values=rev(c(2, 1, 1))) +
xlab("log10(N+P C5 vs. N Change Metric)") +
ylab("log10(S+P C5 vs. S Change Metric)") +
xlim(-4,4) +
ylim(-4,4) +
geom_abline() +
geom_hline(yintercept=0, linetype="dotted") +
geom_vline(xintercept=0, linetype="dotted") +
geom_label_repel(data=volcano_SPP5NPP5Shared[which(volcano_SPP5NPP5Shared$highlight==TRUE),], aes(label=genename.x), size=2, nudge_x = -3)
dp_SPP5NPP5_Shared + themeset
dp_SPP5NPP5_Shared <- ggplot(data=volcano_SPP5NPP5Shared,
aes(x=(log10(abs(`NPP5N_Change Metric`)))*(`NPP5N_Change Metric`/abs(`NPP5N_Change Metric`)),
y=(log10(abs(`SPP5SUB_Change Metric`)))*(`SPP5SUB_Change Metric`/abs(`SPP5SUB_Change Metric`)))) +
geom_point(aes(color=color, size=color)) +
scale_colour_manual(values=rev(c("purple2", colors_fill[2], colors_fill[4]))) +
scale_size_manual(values=rev(c(2, 1, 1))) +
xlab("log10(N+P C5 vs. N Change Metric)") +
ylab("log10(S+P C5 vs. S Change Metric)") +
xlim(-4,4) +
ylim(-4,4) +
geom_abline() +
geom_hline(yintercept=0, linetype="dotted") +
geom_vline(xintercept=0, linetype="dotted") +
geom_label_repel(data=volcano_SPP5NPP5Shared[which(volcano_SPP5NPP5Shared$highlight==TRUE),], aes(label=genename.x), size=2, force=8.6, nudge_x = -3)
dp_SPP5NPP5_Shared + themeset
dp_SPP5NPP5_Shared <- ggplot(data=volcano_SPP5NPP5Shared,
aes(x=(log10(abs(`NPP5N_Change Metric`)))*(`NPP5N_Change Metric`/abs(`NPP5N_Change Metric`)),
y=(log10(abs(`SPP5SUB_Change Metric`)))*(`SPP5SUB_Change Metric`/abs(`SPP5SUB_Change Metric`)))) +
geom_point(aes(color=color, size=color)) +
scale_colour_manual(values=rev(c("purple2", colors_fill[2], colors_fill[4]))) +
scale_size_manual(values=rev(c(2, 1, 1))) +
xlab("log10(N+P C5 vs. N Change Metric)") +
ylab("log10(S+P C5 vs. S Change Metric)") +
xlim(-4,4) +
ylim(-4,4) +
geom_abline() +
geom_hline(yintercept=0, linetype="dotted") +
geom_vline(xintercept=0, linetype="dotted") +
geom_label_repel(data=volcano_SPP5NPP5Shared[which(volcano_SPP5NPP5Shared$highlight==TRUE),], aes(label=genename.x), size=2, force=8.6, nudge_x=-3, nudge_y=1)
dp_SPP5NPP5_Shared + themeset
dp_SPP5NPP5_Shared <- ggplot(data=volcano_SPP5NPP5Shared,
aes(x=(log10(abs(`NPP5N_Change Metric`)))*(`NPP5N_Change Metric`/abs(`NPP5N_Change Metric`)),
y=(log10(abs(`SPP5SUB_Change Metric`)))*(`SPP5SUB_Change Metric`/abs(`SPP5SUB_Change Metric`)))) +
geom_point(aes(color=color, size=color)) +
scale_colour_manual(values=rev(c("purple2", colors_fill[2], colors_fill[4]))) +
scale_size_manual(values=rev(c(2, 1, 1))) +
xlab("log10(N+P C5 vs. N Change Metric)") +
ylab("log10(S+P C5 vs. S Change Metric)") +
xlim(-4,4) +
ylim(-4,4) +
geom_abline() +
geom_hline(yintercept=0, linetype="dotted") +
geom_vline(xintercept=0, linetype="dotted") +
geom_label_repel(data=volcano_SPP5NPP5Shared[which(volcano_SPP5NPP5Shared$highlight==TRUE),], aes(label=genename.x), size=2, force=8.6, nudge_x=1, nudge_y=-1)
dp_SPP5NPP5_Shared + themeset
dp_SPP5NPP5_Shared <- ggplot(data=volcano_SPP5NPP5Shared,
aes(x=(log10(abs(`NPP5N_Change Metric`)))*(`NPP5N_Change Metric`/abs(`NPP5N_Change Metric`)),
y=(log10(abs(`SPP5SUB_Change Metric`)))*(`SPP5SUB_Change Metric`/abs(`SPP5SUB_Change Metric`)))) +
geom_point(aes(color=color, size=color)) +
scale_colour_manual(values=rev(c("purple2", colors_fill[2], colors_fill[4]))) +
scale_size_manual(values=rev(c(2, 1, 1))) +
xlab("log10(N+P C5 vs. N Change Metric)") +
ylab("log10(S+P C5 vs. S Change Metric)") +
xlim(-4,4) +
ylim(-4,4) +
geom_abline() +
geom_hline(yintercept=0, linetype="dotted") +
geom_vline(xintercept=0, linetype="dotted") +
geom_label_repel(data=volcano_SPP5NPP5Shared[which(volcano_SPP5NPP5Shared$highlight==TRUE),], aes(label=genename.x), size=2, force=8.6)
dp_SPP5NPP5_Shared + themeset
?geom_label_repel
temp <- volcano_SPP5NPP5Shared %>% filter(NPP5N_change=="Down")
View(temp)
volcano_SPP5NPP5Shared_highlight <- str_c("Il10", "Tnfsf4", "Tox", "Foxp3", "Ccr6", "Pdcd1", "Il21", "Tigit", "Satb1", sep="|")
volcano_SPP5NPP5Shared <- SPP5NPP5_Shared %>% mutate(highlight=str_detect(genename.x, volcano_SPP5NPP5Shared_highlight))
volcano_SPP5NPP5Shared <- volcano_SPP5NPP5Shared %>% mutate(color="NONE")
volcano_SPP5NPP5Shared$color <- ifelse(abs(volcano_SPP5NPP5Shared$`SPP5SUB_Change Metric`)>abs(volcano_SPP5NPP5Shared$`NPP5N_Change Metric`), "SPP5", "NPP5")
volcano_SPP5NPP5Shared$color <- ifelse(volcano_SPP5NPP5Shared$highlight==TRUE, "highlight", volcano_SPP5NPP5Shared$color)
volcano_SPP5NPP5Shared$color <- factor(volcano_SPP5NPP5Shared$color, levels=rev(c("highlight", "NPP5", "SPP5")))
volcano_SPP5NPP5Shared <- volcano_SPP5NPP5Shared %>% arrange(color)
dp_SPP5NPP5_Shared <- ggplot(data=volcano_SPP5NPP5Shared,
aes(x=(log10(abs(`NPP5N_Change Metric`)))*(`NPP5N_Change Metric`/abs(`NPP5N_Change Metric`)),
y=(log10(abs(`SPP5SUB_Change Metric`)))*(`SPP5SUB_Change Metric`/abs(`SPP5SUB_Change Metric`)))) +
geom_point(aes(color=color, size=color)) +
scale_colour_manual(values=rev(c("purple2", colors_fill[2], colors_fill[4]))) +
scale_size_manual(values=rev(c(2, 1, 1))) +
xlab("log10(N+P C5 vs. N Change Metric)") +
ylab("log10(S+P C5 vs. S Change Metric)") +
xlim(-4,4) +
ylim(-4,4) +
geom_abline() +
geom_hline(yintercept=0, linetype="dotted") +
geom_vline(xintercept=0, linetype="dotted") +
geom_label_repel(data=volcano_SPP5NPP5Shared[which(volcano_SPP5NPP5Shared$highlight==TRUE),], aes(label=genename.x), size=2, force=8.6)
dp_SPP5NPP5_Shared + themeset
library(org.Mm.eg.db)
#library(biomaRt)
library(DESeq2)
library(viridis)
library(uwot)
library(RColorBrewer)
library(gplots)
library(ggplot2)
library(ggrepel)
library(scales)
library(gtable)
library(grid)
library(VennDiagram)
library(tidyverse)
rawCounts <- read.csv('CD8_featureCounts_batch1.csv', header=1)
colors_fill <- c("#38F2E0", "#1A74F8", "#F262F7", "#DA0054")
v_SPP5NPP5_SPP5U <- ggplot(volcano_SPP5NPP5_SPP5U, aes(x=log2FC, y=-log10(padj))) +
geom_point(aes(color=highlight, size=highlight)) +
geom_vline(xintercept=0, linetype="dotted") +
scale_color_manual(values=c("#F2ACC6", "purple2")) +
scale_size_manual(values=c(1.2, 3)) +
ylim(0,50) +
xlim(-50,50) +
geom_label_repel(data=volcano_SPP5NPP5_SPP5U[which(volcano_SPP5NPP5_SPP5U$highlight==TRUE),], aes(label=genename), size=2, nudge_x=c(rep(11, 6), rep(-8, 6)), nudge_y=14, force=3.6) +
themeset + theme(plot.title = element_text(hjust = 0.5)) + ggtitle("SPP5 vs. S")
v_SPP5NPP5_SPP5U
library(org.Mm.eg.db)
#library(biomaRt)
library(DESeq2)
library(viridis)
library(uwot)
library(RColorBrewer)
library(gplots)
library(ggplot2)
library(ggrepel)
library(scales)
library(gtable)
library(grid)
library(VennDiagram)
library(tidyverse)
rawCounts <- read.csv('CD8_featureCounts_batch1.csv', header=1)
colors_fill <- c("#38F2E0", "#1A74F8", "#F262F7", "#DA0054")
SPP7NPP5_SharedUp <- inner_join(listSPP7SUBUp, listNPP5NUp, by="Geneid")
SPP7NPP5_SharedDown <- inner_join(listSPP7SUBDown, listNPP5NDown, by="Geneid")
SPP7NPP5_Shared <- inner_join(listSPP7SUB, listNPP5N, by="Geneid")
SPP7NPP5_Shared <- SPP7SPP5_Shared %>% filter(SPP7SUB_change==NPP5N_change)
SPP7NPP5_NPP5U <- listNPP5N %>% filter(!Geneid %in% listSPP7SUB$Geneid)
colnames(SPP7SPP5_NPP5U) <- colnames(SPP7SPP5_NPP5U) %>% str_replace_all("NPP5N_", "")
SPP7NPP5_NPP5UDown <- SPP7SPP5_NPP5U %>% filter(`Change Metric`<0)
SPP7NPP5_NPP5UUp <- SPP7SPP5_NPP5U %>% filter(`Change Metric`>0)
SPP7NPP5_SPP7U <- listSPP7SUB %>% filter(!Geneid %in% listNPP5N$Geneid)
colnames(SPP7NPP5_SPP7U) <- colnames(SPP7SPP5_SPP7U) %>% str_replace_all("SPP7SUB_", "")
SPP7NPP5_SPP7UDown <- SPP7SPP5_SPP7U %>% filter(`Change Metric`<0)
SPP7NPP5_SPP7UUp <- SPP7SPP5_SPP7U %>% filter(`Change Metric`>0)
#Build Shared/unique list for S+P Cluster 7 vs. NPP5
SPP7NPP5_SharedUp <- inner_join(listSPP7SUBUp, listNPP5NUp, by="Geneid")
SPP7NPP5_SharedDown <- inner_join(listSPP7SUBDown, listNPP5NDown, by="Geneid")
SPP7NPP5_Shared <- inner_join(listSPP7SUB, listNPP5N, by="Geneid")
SPP7NPP5_Shared <- SPP7SPP5_Shared %>% filter(SPP7SUB_change==NPP5N_change)
View(listSPP7SUB)
View(listNPP5N)
#Build Shared/unique list for S+P Cluster 7 vs. NPP5
SPP7NPP5_SharedUp <- inner_join(listSPP7SUBUp, listNPP5NUp, by="Geneid")
SPP7NPP5_SharedDown <- inner_join(listSPP7SUBDown, listNPP5NDown, by="Geneid")
SPP7NPP5_Shared <- inner_join(listSPP7SUB, listNPP5N, by="Geneid")
View(SPP7NPP5_Shared)
SPP7NPP5_Shared <- SPP7NPP5_Shared %>% filter(SPP7SUB_change==NPP5N_change)
SPP7NPP5_SharedUp <- inner_join(listSPP7SUBUp, listNPP5NUp, by="Geneid")
SPP7NPP5_SharedDown <- inner_join(listSPP7SUBDown, listNPP5NDown, by="Geneid")
SPP7NPP5_Shared <- inner_join(listSPP7SUB, listNPP5N, by="Geneid")
SPP7NPP5_Shared <- SPP7NPP5_Shared %>% filter(SPP7SUB_change==NPP5N_change)
SPP7NPP5_NPP5U <- listNPP5N %>% filter(!Geneid %in% listSPP7SUB$Geneid)
colnames(SPP7SPP5_NPP5U) <- colnames(SPP7SPP5_NPP5U) %>% str_replace_all("NPP5N_", "")
SPP7NPP5_NPP5UDown <- SPP7NPP5_NPP5U %>% filter(`Change Metric`<0)
SPP7NPP5_NPP5UUp <- SPP7NPP5_NPP5U %>% filter(`Change Metric`>0)
SPP7NPP5_NPP5U <- listNPP5N %>% filter(!Geneid %in% listSPP7SUB$Geneid)
colnames(SPP7NPP5_NPP5U) <- colnames(SPP7SPP5_NPP5U) %>% str_replace_all("NPP5N_", "")
SPP7NPP5_NPP5U <- listNPP5N %>% filter(!Geneid %in% listSPP7SUB$Geneid)
colnames(SPP7NPP5_NPP5U) <- colnames(SPP7NPP5_NPP5U) %>% str_replace_all("NPP5N_", "")
SPP7NPP5_NPP5UDown <- SPP7NPP5_NPP5U %>% filter(`Change Metric`<0)
SPP7NPP5_NPP5UUp <- SPP7NPP5_NPP5U %>% filter(`Change Metric`>0)
SPP7NPP5_SPP7U <- listSPP7SUB %>% filter(!Geneid %in% listNPP5N$Geneid)
colnames(SPP7NPP5_SPP7U) <- colnames(SPP7NPP5_SPP7U) %>% str_replace_all("SPP7SUB_", "")
SPP7NPP5_SPP7UDown <- SPP7NPP5_SPP7U %>% filter(`Change Metric`<0)
SPP7NPP5_SPP7UUp <- SPP7NPP5_SPP7U %>% filter(`Change Metric`>0)
comparisons <- comparisons[str_detect(comparisons, "SPP7NPP5_")]
for(i in comparisons){
expList(str2lang(i))
}
comparisons <- c(ls(pattern="Up"), ls(pattern="Down"))
comparisons <- comparisons[str_detect(comparisons, "SPP7NPP5_")]
for(i in comparisons){
expList(str2lang(i))
}
library(org.Mm.eg.db)
#library(biomaRt)
library(DESeq2)
library(viridis)
library(uwot)
library(RColorBrewer)
library(gplots)
library(ggplot2)
library(ggrepel)
library(scales)
library(gtable)
library(grid)
library(VennDiagram)
library(tidyverse)
rawCounts <- read.csv('CD8_featureCounts_batch1.csv', header=1)
colors_fill <- c("#38F2E0", "#1A74F8", "#F262F7", "#DA0054")
sessionInfo()
View(SPP5NPP5_Shared_Unequal)
SPP5NPP5_SharedUnequal <- inner_join(SPP5NPP5_Shared, listSPP5NPP5, by="Geneid", suffix=c("_Shared", "_diff"))
library(org.Mm.eg.db)
#library(biomaRt)
library(DESeq2)
library(viridis)
library(uwot)
library(RColorBrewer)
library(gplots)
library(ggplot2)
library(ggrepel)
library(scales)
library(gtable)
library(grid)
library(VennDiagram)
library(tidyverse)
rawCounts <- read.csv('CD8_featureCounts_batch1.csv', header=1)
colors_fill <- c("#38F2E0", "#1A74F8", "#F262F7", "#DA0054")
SPP5NPP5_SharedUnequal <- inner_join(SPP5NPP5_Shared, listSPP5NPP5, by="Geneid", suffix=c("_Shared", "_diff"))
rm(SPP5NPP5_SharedUnequal)
SPP5NPP5_Shared_Unequal <- inner_join(SPP5NPP5_Shared, listSPP5NPP5, by="Geneid", suffix=c("_Shared", "_diff"))
SPP5NPP5_Shared_Unequal <- inner_join(SPP5NPP5_Shared, listSPP5NPP5, by="Geneid", suffix=c("_Shared", "_diff"))
rm(SPP5NPP5_Shared_Unequal)
SPP5NPP5_Shared_Unequal <- inner_join(SPP5NPP5_Shared, listSPP5NPP5, by="Geneid", suffix=c("_Shared", "_diff"))
SPP5NPP5_SharedUnequal <- inner_join(SPP5NPP5_Shared, listSPP5NPP5, by="Geneid", suffix=c("_Shared", "_diff"))
rm(SPP5NPP5_Shared_Unequal)
View(SPP5NPP5_SharedUnequal)
dp_SPP5NPP5_Shared + themeset
dp_SPP5NPP5_Shared <- ggplot(data=volcano_SPP5NPP5Shared,
aes(x=(log10(abs(`NPP5N_Change Metric`)))*(`NPP5N_Change Metric`/abs(`NPP5N_Change Metric`)),
y=(log10(abs(`SPP5SUB_Change Metric`)))*(`SPP5SUB_Change Metric`/abs(`SPP5SUB_Change Metric`)))) +
geom_point(aes(color=color, size=color)) +
scale_colour_manual(values=rev(c("purple2", colors_fill[2], colors_fill[4]))) +
scale_size_manual(values=rev(c(2, 1, 1))) +
xlab("log10(N+P C5 vs. N Change Metric)") +
ylab("log10(S+P C5 vs. S Change Metric)") +
xlim(-4,4) +
ylim(-4,4) +
geom_abline() +
geom_hline(yintercept=0, linetype="dotted") +
geom_vline(xintercept=0, linetype="dotted") +
geom_label_repel(data=volcano_SPP5NPP5Shared[], aes(label=genename.x), size=2, force=8.6)
dp_SPP5NPP5_Shared + themeset
dp_SPP5NPP5_Shared <- ggplot(data=volcano_SPP5NPP5Shared,
aes(x=(log10(abs(`NPP5N_Change Metric`)))*(`NPP5N_Change Metric`/abs(`NPP5N_Change Metric`)),
y=(log10(abs(`SPP5SUB_Change Metric`)))*(`SPP5SUB_Change Metric`/abs(`SPP5SUB_Change Metric`)))) +
geom_point(aes(color=color, size=color)) +
scale_colour_manual(values=rev(c("purple2", colors_fill[2], colors_fill[4]))) +
scale_size_manual(values=rev(c(2, 1, 1))) +
xlab("log10(N+P C5 vs. N Change Metric)") +
ylab("log10(S+P C5 vs. S Change Metric)") +
xlim(-10,10) +
ylim(-10,10) +
geom_abline() +
geom_hline(yintercept=0, linetype="dotted") +
geom_vline(xintercept=0, linetype="dotted") +
geom_label_repel(data=volcano_SPP5NPP5Shared[], aes(label=genename.x), size=2, force=20)
dp_SPP5NPP5_Shared + themeset
?geom_label_repel
dp_SPP5NPP5_Shared <- ggplot(data=volcano_SPP5NPP5Shared,
aes(x=(log10(abs(`NPP5N_Change Metric`)))*(`NPP5N_Change Metric`/abs(`NPP5N_Change Metric`)),
y=(log10(abs(`SPP5SUB_Change Metric`)))*(`SPP5SUB_Change Metric`/abs(`SPP5SUB_Change Metric`)))) +
geom_point(aes(color=color, size=color)) +
scale_colour_manual(values=rev(c("purple2", colors_fill[2], colors_fill[4]))) +
scale_size_manual(values=rev(c(2, 1, 1))) +
xlab("log10(N+P C5 vs. N Change Metric)") +
ylab("log10(S+P C5 vs. S Change Metric)") +
xlim(-10,10) +
ylim(-10,10) +
geom_abline() +
geom_hline(yintercept=0, linetype="dotted") +
geom_vline(xintercept=0, linetype="dotted") +
geom_label_repel(data=volcano_SPP5NPP5Shared[], aes(label=genename.x), size=2, force=20, max.overlaps=100)
dp_SPP5NPP5_Shared + themeset
dp_SPP5NPP5_Shared <- ggplot(data=volcano_SPP5NPP5Shared,
aes(x=(log10(abs(`NPP5N_Change Metric`)))*(`NPP5N_Change Metric`/abs(`NPP5N_Change Metric`)),
y=(log10(abs(`SPP5SUB_Change Metric`)))*(`SPP5SUB_Change Metric`/abs(`SPP5SUB_Change Metric`)))) +
geom_point(aes(color=color, size=color)) +
scale_colour_manual(values=rev(c("purple2", colors_fill[2], colors_fill[4]))) +
scale_size_manual(values=rev(c(2, 1, 1))) +
xlab("log10(N+P C5 vs. N Change Metric)") +
ylab("log10(S+P C5 vs. S Change Metric)") +
xlim(-4,4) +
ylim(-4,4) +
geom_abline() +
geom_hline(yintercept=0, linetype="dotted") +
geom_vline(xintercept=0, linetype="dotted") +
geom_label_repel(data=volcano_SPP5NPP5Shared[which(volcano_SPP5NPP5Shared$highlight==TRUE),], aes(label=genename.x), size=2, force=8.6)
dp_SPP5NPP5_Shared + themeset
View(listNPP5N_full)
View(listSPP5SUB_full)
View(listSPP5NPP5_full)
library(org.Mm.eg.db)
#library(biomaRt)
library(DESeq2)
library(viridis)
library(uwot)
library(RColorBrewer)
library(gplots)
library(ggplot2)
library(ggrepel)
library(scales)
library(gtable)
library(grid)
library(VennDiagram)
library(tidyverse)
rawCounts <- read.csv('CD8_featureCounts_batch1.csv', header=1)
colors_fill <- c("#38F2E0", "#1A74F8", "#F262F7", "#DA0054")
genListFull <- function(x, direction="NULL", include_symbol=TRUE){
name <- deparse(substitute(x))
identity <- str_replace(name, "res.", "")
identitychange <- paste(identity, "change", sep="_")
identitypadj <- paste(identity, "padj", sep="_")
identityfc <- paste(identity, "log2FC", sep="_")
identitycm <- paste(identity, "Change Metric", sep="_")
y <- as.data.frame(x[order(abs(x$log2FoldChange), decreasing=T),])
y <- y %>% mutate(!!identitychange := ifelse(y$log2FoldChange<0, "Down", "Up"))
y <- y %>% dplyr::select(c(!!identitychange, log2FoldChange, padj, pvalue))
if(include_symbol==TRUE){
y <- y %>% mutate(Geneid=row.names(y), .before=!!identitychange) %>% left_join(anno, by=c("Geneid" = "ENSEMBL")) %>% relocate(SYMBOL, .after=Geneid) %>% mutate(genename = coalesce(SYMBOL, Geneid), .after=Geneid) %>% select(-c(SYMBOL))
}
y <- y %>% dplyr::rename(!!identitypadj := "padj")
y <- y %>% dplyr::rename(!!identityfc := "log2FoldChange")
}
listSPP5NPP5_full <- genListFull(res.SPP5NPP5)
listNPP5N_full <- genListFull(res.NPP5N)
listSUBN_full <- genListFull(res.SUBN)
listSUBNPP5_full <- genListFull(res.SUBNPP5)
listSPP5NPP5_full <- genListFull(res.SPP5NPP5)
listSPP5SUB_full <- genListFull(res.SPP5SUB)
SPP5NPP5_Shared_UnequalCheck <- inner_join(SPP5NPP5_Shared, listSPP5NPP5_full, by="Geneid")
View(SPP5NPP5_Shared_UnequalCheck)
volcano_SPP5NPP5Shared_highlight <- str_c("Fyn", "Il10", "Tnfsf4", "Tox", "Foxp3", "Ccr6", "Pdcd1", "Il21", "Tigit", "Satb1", sep="|")
volcano_SPP5NPP5Shared <- SPP5NPP5_Shared %>% mutate(highlight=str_detect(genename.x, volcano_SPP5NPP5Shared_highlight))
volcano_SPP5NPP5Shared <- volcano_SPP5NPP5Shared %>% mutate(color="NONE")
volcano_SPP5NPP5Shared$color <- ifelse(abs(volcano_SPP5NPP5Shared$`SPP5SUB_Change Metric`)>abs(volcano_SPP5NPP5Shared$`NPP5N_Change Metric`), "SPP5", "NPP5")
volcano_SPP5NPP5Shared$color <- ifelse(volcano_SPP5NPP5Shared$highlight==TRUE, "highlight", volcano_SPP5NPP5Shared$color)
volcano_SPP5NPP5Shared$color <- factor(volcano_SPP5NPP5Shared$color, levels=rev(c("highlight", "NPP5", "SPP5")))
volcano_SPP5NPP5Shared <- volcano_SPP5NPP5Shared %>% arrange(color)
dp_SPP5NPP5_Shared <- ggplot(data=volcano_SPP5NPP5Shared,
aes(x=(log10(abs(`NPP5N_Change Metric`)))*(`NPP5N_Change Metric`/abs(`NPP5N_Change Metric`)),
y=(log10(abs(`SPP5SUB_Change Metric`)))*(`SPP5SUB_Change Metric`/abs(`SPP5SUB_Change Metric`)))) +
geom_point(aes(color=color, size=color)) +
scale_colour_manual(values=rev(c("purple2", colors_fill[2], colors_fill[4]))) +
scale_size_manual(values=rev(c(2, 1, 1))) +
xlab("log10(N+P C5 vs. N Change Metric)") +
ylab("log10(S+P C5 vs. S Change Metric)") +
xlim(-4,4) +
ylim(-4,4) +
geom_abline() +
geom_hline(yintercept=0, linetype="dotted") +
geom_vline(xintercept=0, linetype="dotted") +
geom_label_repel(data=volcano_SPP5NPP5Shared[which(volcano_SPP5NPP5Shared$highlight==TRUE),], aes(label=genename.x), size=2, force=8.6)
dp_SPP5NPP5_Shared + themeset
View(SPP5NPP5_Shared_UnequalCheck)
View(SPP5NPP5_Shared)
write.csv(SPP5NPP5_Shared, "SPP5NPP5SharedDPStats.csv")
View(listSPP5SUB)
View(listSPP5SUB_full)
View(listSPP5NPP5_full)
View(listSPP5NPP5_full)
genListFull <- function(x, direction="NULL", include_symbol=TRUE){
name <- deparse(substitute(x))
identity <- str_replace(name, "res.", "")
identitychange <- paste(identity, "change", sep="_")
identitypadj <- paste(identity, "padj", sep="_")
identityfc <- paste(identity, "log2FC", sep="_")
identitycm <- paste(identity, "Change Metric", sep="_")
y <- as.data.frame(x[order(abs(x$log2FoldChange), decreasing=T),])
y <- y %>% mutate(!!identitychange := ifelse(y$log2FoldChange<0, "Down", "Up"))
y <- y %>% dplyr::select(c(!!identitychange, log2FoldChange, padj, pvalue))
if(include_symbol==TRUE){
y <- y %>% mutate(Geneid=row.names(y), .before=!!identitychange) %>% left_join(anno, by=c("Geneid" = "ENSEMBL")) %>% relocate(SYMBOL, .after=Geneid) %>% mutate(genename = coalesce(SYMBOL, Geneid), .after=Geneid) %>% select(-c(SYMBOL))
}
y <- y %>% dplyr::rename(!!identitypadj := "padj")
y <- y %>% dplyr::rename(!!identityfc := "log2FoldChange")
}
listSPP5NPP5_full <- genListFull(res.SPP5NPP5)
library(org.Mm.eg.db)
#library(biomaRt)
library(DESeq2)
library(viridis)
library(uwot)
library(RColorBrewer)
library(gplots)
library(ggplot2)
library(ggrepel)
library(scales)
library(gtable)
library(grid)
library(VennDiagram)
library(tidyverse)
rawCounts <- read.csv('CD8_featureCounts_batch1.csv', header=1)
colors_fill <- c("#38F2E0", "#1A74F8", "#F262F7", "#DA0054")
listSPP5NPP5_full <- genListFull(res.SPP5NPP5)
install.packages(c('BiocManager', 'dplyr', 'gplots', 'ggplot2', 'ggrepel', 'stringr', 'Signac'))
BiocManager::install(c('imma', 'DESeq2', 'AnnotationDbi', 'org.Mm.eg.db', 'ReportingTools', 'GO.db', 'GOstats', 'pathview', 'gage', 'gageData', 'select', 'ChIPpeakAnno', 'GenomicRanges', 'EnsDb.Mmusculus.v79'))
library(org.Mm.eg.db)
#library(biomaRt)
library(DESeq2)
library(viridis)
library(uwot)
install.packages("viridis", "uwot")
install.packages("viridis", "uwot")
install.packages(c("viridis", "uwot"))
library(org.Mm.eg.db)
#library(biomaRt)
library(DESeq2)
library(viridis)
library(uwot)
library(RColorBrewer)
library(gplots)
library(ggplot2)
library(ggrepel)
library(scales)
library(gtable)
library(grid)
library(VennDiagram)
library(tidyverse)
install.packages(c("viridis", "uwot", "tidyverse"))
install.packages(c("viridis", "uwot", "tidyverse"))
library(org.Mm.eg.db)
#library(biomaRt)
library(DESeq2)
library(viridis)
library(uwot)
library(RColorBrewer)
library(gplots)
library(ggplot2)
library(ggrepel)
library(scales)
library(gtable)
library(grid)
library(VennDiagram)
library(tidyverse)
rawCounts <- read.csv('CD8_featureCounts_batch1.csv', header=1)
colors_fill <- c("#38F2E0", "#1A74F8", "#F262F7", "#DA0054")
library(org.Mm.eg.db)
#library(biomaRt)
library(DESeq2)
library(viridis)
library(uwot)
library(RColorBrewer)
library(gplots)
library(ggplot2)
library(ggrepel)
library(scales)
library(gtable)
library(grid)
library(VennDiagram)
library(tidyverse)
rawCounts <- read.csv('CD8_featureCounts_batch1.csv', header=1)
colors_fill <- c("#38F2E0", "#1A74F8", "#F262F7", "#DA0054")
heatmap.2(as.matrix(heatmapdata_clustered4[,1:(ncol(heatmapdata_clustered4)-1)]), col=plasma(n=30), main="KMeans-clustered Heatmap", trace= "none", density.info="none", key=TRUE, symkey=FALSE, keysize=1.26, key.xlab="Z-score", Colv=FALSE, Rowv=FALSE, margins=c(6,4), cexCol=1, labRow=FALSE, RowSideColors=clustercolors4, ColSideColors=heatmapgroupcolors, breaks=seq(-2, 3.5, length.out=31))
grid.draw(b_colors)
dev.off
dev.off()
grid.draw(b_colors)
View(listSPP5NPP5_full)
library(org.Mm.eg.db)
#library(biomaRt)
library(DESeq2)
library(viridis)
library(uwot)
library(RColorBrewer)
library(gplots)
library(ggplot2)
library(ggrepel)
library(scales)
library(gtable)
library(grid)
library(VennDiagram)
library(tidyverse)
rawCounts <- read.csv('CD8_featureCounts_batch1.csv', header=1)
colors_fill <- c("#38F2E0", "#1A74F8", "#F262F7", "#DA0054")
listSPP5NPP5_full <- genListFull(res.SPP5NPP5)
View(listSPP5NPP5_full)
View(listSPP5SUB_full)
