scale_x_continuous(breaks=c(-5:-1,1:7), labels=SUBN_plot$NAME) +
scale_y_continuous(breaks=c(-1.5, -1, -0.5, 0, 0.5, 1, 1.5), limits=c(-1.5, 1.5)) +
ggtitle("GSEA Enrichment For SUB vs. N Trancription")
SUBN_gg + coord_flip()
SUBN_plot <- bind_rows("Neg"=GSEA_SUBNDown, "Pos"=GSEA_SUBNUp, .id="ID")
SUBN_plot$Y <- if_else(SUBN_plot$ID=="Neg", (SUBN_plot$Y * -1), (SUBN_plot$Y * 1))
SUBN_plot <- SUBN_plot %>% arrange(Y)
SUBN_gg <- ggplot(SUBN_plot, aes(x=Y, y=NES, fill=FDR)) + ylab("Normalized Enrichment Score") + xlab("") + themeset
SUBN_gg <- SUBN_gg + geom_col(color="black") +
labs(color='FDR q-value:') +
#scale_fill_gradientn(colors=mako(n=100, begin=0.71, end=0.15), limits=c(0,1)) +
scale_fill_gradientn(colors=plasma(n=100, begin=0.8, end=0)) +
scale_x_continuous(breaks=c(-5:-1,1:7), labels=SUBN_plot$NAME) +
scale_y_continuous(breaks=c(-1.5, -1, -0.5, 0, 0.5, 1, 1.5), limits=c(-1.5, 1.5)) +
ggtitle("GSEA Enrichment For SUB vs. N Trancription")
SUBN_gg + coord_flip()
SUBN_plot <- bind_rows("Neg"=GSEA_SUBNDown, "Pos"=GSEA_SUBNUp, .id="ID")
SUBN_plot$Y <- if_else(SUBN_plot$ID=="Neg", (SUBN_plot$Y * -1), (SUBN_plot$Y * 1))
SUBN_plot <- SUBN_plot %>% arrange(Y)
SUBN_gg <- ggplot(SUBN_plot, aes(x=Y, y=NES, fill=FDR)) + ylab("Normalized Enrichment Score") + xlab("") + themeset
SUBN_gg <- SUBN_gg + geom_col(color="black") +
labs(color='FDR q-value:') +
#scale_fill_gradientn(colors=mako(n=100, begin=0.71, end=0.15), limits=c(0,1)) +
scale_fill_gradientn(colors=plasma(n=100, begin=0.8, end=0), breaks=seq(0, 1, by=0.1)) +
scale_x_continuous(breaks=c(-5:-1,1:7), labels=SUBN_plot$NAME) +
scale_y_continuous(breaks=c(-1.5, -1, -0.5, 0, 0.5, 1, 1.5), limits=c(-1.5, 1.5)) +
ggtitle("GSEA Enrichment For SUB vs. N Trancription")
SUBN_gg + coord_flip()
SPP5U_plot <- bind_rows("Neg"=GSEA_SPP5NPP5_SPP5U_Neg, "Pos"=GSEA_SPP5NPP5_SPP5U_Pos, .id="ID")
SPP5U_plot$Y <- if_else(SPP5U_plot$ID=="Neg", (SPP5U_plot$Y * -1), (SPP5U_plot$Y * 1))
SPP5U_plot <- SPP5U_plot %>% arrange(Y)
SPP5U_gg <- ggplot(SPP5U_plot, aes(x=Y, y=NES, fill=FDR)) + ylab("Normalized Enrichment Score") + xlab("") + themeset
SPP5U_gg <- SPP5U_gg + geom_col(color="black") +
labs(color='FDR q-value:') +
#scale_fill_gradientn(colors=mako(n=100, begin=0.71, end=0.15), limits=c(0,1)) +
scale_fill_gradientn(colors=plasma(n=100, begin=0.8, end=0)) +
scale_x_continuous(breaks=c(-5:-1,1:5), labels=SPP5U_plot$NAME) +
scale_y_continuous(breaks=c(-2, -1.5, -1, -0.5, 0, 0.5, 1, 1.5, 2), limits=c(-2, 2)) +
ggtitle("GSEA Enrichment For Sens+Preg-Unique Trancription")
SPP5U_gg + coord_flip()
View(GSEA_SPP5NPP5_SPP5U_Neg)
SPP5U_plot <- bind_rows("Neg"=GSEA_SPP5NPP5_SPP5U_Neg, "Pos"=GSEA_SPP5NPP5_SPP5U_Pos, .id="ID")
SPP5U_plot$Y <- if_else(SPP5U_plot$ID=="Neg", (SPP5U_plot$Y * -1), (SPP5U_plot$Y * 1))
SPP5U_plot <- SPP5U_plot %>% arrange(Y)
SPP5U_gg <- ggplot(SPP5U_plot, aes(x=Y, y=NES, fill=FDR)) + ylab("Normalized Enrichment Score") + xlab("") + themeset
SPP5U_gg <- SPP5U_gg + geom_col(color="black") +
labs(color='FDR q-value:') +
#scale_fill_gradientn(colors=mako(n=100, begin=0.71, end=0.15), limits=c(0,1)) +
scale_fill_gradientn(colors=plasma(n=100, begin=0.8, end=0), breaks=seq(0, 1, by=0.1)) +
scale_x_continuous(breaks=c(-5:-1,1:5), labels=SPP5U_plot$NAME) +
scale_y_continuous(breaks=c(-2, -1.5, -1, -0.5, 0, 0.5, 1, 1.5, 2), limits=c(-2, 2)) +
ggtitle("GSEA Enrichment For Sens+Preg-Unique Trancription")
SPP5U_gg + coord_flip()
Shared_plot <- bind_rows("Neg"=GSEA_SPP5NPP5Shared_Neg, "Pos"=GSEA_SPP5NPP5Shared_Pos, .id="ID")
Shared_plot$Y <- if_else(Shared_plot$ID=="Neg", (Shared_plot$Y * -1), (Shared_plot$Y * 1))
Shared_plot <- Shared_plot %>% arrange(Y)
Shared_gg <- ggplot(Shared_plot, aes(x=Y, y=NES, fill=FDR)) + ylab("Normalized Enrichment Score") + xlab("") + themeset
Shared_gg <- Shared_gg + geom_col(color="black") +
labs(color='FDR q-value:') +
#scale_fill_gradientn(colors=mako(n=100, begin=0.71, end=0.15), limits=c(0,1)) +
scale_fill_gradientn(colors=plasma(n=100, begin=0.8, end=0), breaks=seq(0, 1, by=0.1)) +
scale_x_continuous(breaks=c(-4:-1,1:3), labels=Shared_plot$NAME) +
scale_y_continuous(breaks=c(-1.5, -1, -0.5, 0, 0.5, 1, 1.5), limits=c(-1.5, 1.5)) +
ggtitle("GSEA Enrichment For Shared Pregnancy Trancription")
Shared_gg + coord_flip()
Shared_plot <- bind_rows("Neg"=GSEA_SPP5NPP5Shared_Neg, "Pos"=GSEA_SPP5NPP5Shared_Pos, .id="ID")
Shared_plot$Y <- if_else(Shared_plot$ID=="Neg", (Shared_plot$Y * -1), (Shared_plot$Y * 1))
Shared_plot <- Shared_plot %>% arrange(Y)
Shared_gg <- ggplot(Shared_plot, aes(x=Y, y=NES, fill=FDR)) + ylab("Normalized Enrichment Score") + xlab("") + themeset
Shared_gg <- Shared_gg + geom_col(color="black") +
labs(color='FDR q-value:') +
#scale_fill_gradientn(colors=mako(n=100, begin=0.71, end=0.15), limits=c(0,1)) +
scale_fill_gradientn(colors=plasma(n=100, begin=0.8, end=0), breaks=seq(0, 1, by=0.051)) +
scale_x_continuous(breaks=c(-4:-1,1:3), labels=Shared_plot$NAME) +
scale_y_continuous(breaks=c(-1.5, -1, -0.5, 0, 0.5, 1, 1.5), limits=c(-1.5, 1.5)) +
ggtitle("GSEA Enrichment For Shared Pregnancy Trancription")
Shared_gg + coord_flip()
Shared_plot <- bind_rows("Neg"=GSEA_SPP5NPP5Shared_Neg, "Pos"=GSEA_SPP5NPP5Shared_Pos, .id="ID")
Shared_plot$Y <- if_else(Shared_plot$ID=="Neg", (Shared_plot$Y * -1), (Shared_plot$Y * 1))
Shared_plot <- Shared_plot %>% arrange(Y)
Shared_gg <- ggplot(Shared_plot, aes(x=Y, y=NES, fill=FDR)) + ylab("Normalized Enrichment Score") + xlab("") + themeset
Shared_gg <- Shared_gg + geom_col(color="black") +
labs(color='FDR q-value:') +
#scale_fill_gradientn(colors=mako(n=100, begin=0.71, end=0.15), limits=c(0,1)) +
scale_fill_gradientn(colors=plasma(n=100, begin=0.8, end=0), breaks=seq(0, 1, by=0.05)) +
scale_x_continuous(breaks=c(-4:-1,1:3), labels=Shared_plot$NAME) +
scale_y_continuous(breaks=c(-1.5, -1, -0.5, 0, 0.5, 1, 1.5), limits=c(-1.5, 1.5)) +
ggtitle("GSEA Enrichment For Shared Pregnancy Trancription")
Shared_gg + coord_flip()
Shared_plot <- bind_rows("Neg"=GSEA_SPP5NPP5Shared_Neg, "Pos"=GSEA_SPP5NPP5Shared_Pos, .id="ID")
Shared_plot$Y <- if_else(Shared_plot$ID=="Neg", (Shared_plot$Y * -1), (Shared_plot$Y * 1))
Shared_plot <- Shared_plot %>% arrange(Y)
Shared_gg <- ggplot(Shared_plot, aes(x=Y, y=NES, fill=FDR)) + ylab("Normalized Enrichment Score") + xlab("") + themeset
Shared_gg <- Shared_gg + geom_col(color="black") +
labs(color='FDR q-value:') +
#scale_fill_gradientn(colors=mako(n=100, begin=0.71, end=0.15), limits=c(0,1)) +
scale_fill_gradientn(colors=plasma(n=100, begin=0.8, end=0), breaks=seq(0, 1, by=0.1)) +
scale_x_continuous(breaks=c(-4:-1,1:3), labels=Shared_plot$NAME) +
scale_y_continuous(breaks=c(-1.5, -1, -0.5, 0, 0.5, 1, 1.5), limits=c(-1.5, 1.5)) +
ggtitle("GSEA Enrichment For Shared Pregnancy Trancription")
Shared_gg + coord_flip()
NPP5U_plot <- bind_rows("Neg"=GSEA_SPP5NPP5_NPP5U_Neg, "Pos"=GSEA_SPP5NPP5_NPP5U_Pos, .id="ID")
NPP5U_plot$Y <- if_else(NPP5U_plot$ID=="Neg", (NPP5U_plot$Y * -1), (NPP5U_plot$Y * 1))
NPP5U_plot <- NPP5U_plot %>% arrange(Y)
NPP5U_gg <- ggplot(NPP5U_plot, aes(x=Y, y=NES, fill=FDR)) + ylab("Normalized Enrichment Score") + xlab("") + themeset
NPP5U_gg <- NPP5U_gg + geom_col(color="black") +
labs(color='FDR q-value:') +
#scale_fill_gradientn(colors=mako(n=100, begin=0.71, end=0.15), limits=c(0,1)) +
scale_fill_gradientn(colors=plasma(n=100, begin=0.8, end=0), breaks=seq(0, 1, by=0.1)) +
scale_x_continuous(breaks=c(-3:-1,1:6), labels=NPP5U_plot$NAME) +
scale_y_continuous(breaks=c(-2, -1.5, -1, -0.5, 0, 0.5, 1, 1.5, 2), limits=c(-2, 2)) +
ggtitle("GSEA Enrichment For Naive+Preg-Unique Trancription")
NPP5U_gg + coord_flip()
SUBN_gg + coord_flip()
View(GSEA_SUBNUp)
View(GSEA_SUBNDown)
SUBN_plot <- bind_rows("Neg"=GSEA_SUBNDown, "Pos"=GSEA_SUBNUp, .id="ID")
SUBN_plot$Y <- if_else(SUBN_plot$ID=="Neg", (SUBN_plot$Y * -1), (SUBN_plot$Y * 1))
SUBN_plot <- SUBN_plot %>% arrange(Y)
SUBN_gg <- ggplot(SUBN_plot, aes(x=Y, y=NES, fill=FDR)) + ylab("Normalized Enrichment Score") + xlab("") + themeset
SUBN_gg <- SUBN_gg + geom_col(color="black") +
labs(color='FDR q-value:') +
#scale_fill_gradientn(colors=mako(n=100, begin=0.71, end=0.15), limits=c(0,1)) +
scale_fill_gradientn(colors=plasma(n=100, begin=0.8, end=0.25), breaks=seq(0, 1, by=0.1)) +
scale_x_continuous(breaks=c(-5:-1,1:7), labels=SUBN_plot$NAME) +
scale_y_continuous(breaks=c(-1.5, -1, -0.5, 0, 0.5, 1, 1.5), limits=c(-1.5, 1.5)) +
ggtitle("GSEA Enrichment For SUB vs. N Trancription")
SUBN_gg + coord_flip()
NPP5U_plot <- bind_rows("Neg"=GSEA_SPP5NPP5_NPP5U_Neg, "Pos"=GSEA_SPP5NPP5_NPP5U_Pos, .id="ID")
NPP5U_plot$Y <- if_else(NPP5U_plot$ID=="Neg", (NPP5U_plot$Y * -1), (NPP5U_plot$Y * 1))
NPP5U_plot <- NPP5U_plot %>% arrange(Y)
NPP5U_gg <- ggplot(NPP5U_plot, aes(x=Y, y=NES, fill=FDR)) + ylab("Normalized Enrichment Score") + xlab("") + themeset
NPP5U_gg <- NPP5U_gg + geom_col(color="black") +
labs(color='FDR q-value:') +
#scale_fill_gradientn(colors=mako(n=100, begin=0.71, end=0.15), limits=c(0,1)) +
scale_fill_gradientn(colors=plasma(n=100, begin=0.6, end=0), breaks=seq(0, 1, by=0.1)) +
scale_x_continuous(breaks=c(-3:-1,1:6), labels=NPP5U_plot$NAME) +
scale_y_continuous(breaks=c(-2, -1.5, -1, -0.5, 0, 0.5, 1, 1.5, 2), limits=c(-2, 2)) +
ggtitle("GSEA Enrichment For Naive+Preg-Unique Trancription")
NPP5U_gg + coord_flip()
NPP5U_plot <- bind_rows("Neg"=GSEA_SPP5NPP5_NPP5U_Neg, "Pos"=GSEA_SPP5NPP5_NPP5U_Pos, .id="ID")
NPP5U_plot$Y <- if_else(NPP5U_plot$ID=="Neg", (NPP5U_plot$Y * -1), (NPP5U_plot$Y * 1))
NPP5U_plot <- NPP5U_plot %>% arrange(Y)
NPP5U_gg <- ggplot(NPP5U_plot, aes(x=Y, y=NES, fill=FDR)) + ylab("Normalized Enrichment Score") + xlab("") + themeset
NPP5U_gg <- NPP5U_gg + geom_col(color="black") +
labs(color='FDR q-value:') +
#scale_fill_gradientn(colors=mako(n=100, begin=0.71, end=0.15), limits=c(0,1)) +
scale_fill_gradientn(colors=plasma(n=100, begin=0.8, end=0), breaks=seq(0, 1, by=0.1)) +
scale_x_continuous(breaks=c(-3:-1,1:6), labels=NPP5U_plot$NAME) +
scale_y_continuous(breaks=c(-2, -1.5, -1, -0.5, 0, 0.5, 1, 1.5, 2), limits=c(-2, 2)) +
ggtitle("GSEA Enrichment For Naive+Preg-Unique Trancription")
NPP5U_gg + coord_flip()
SUBN_plot <- bind_rows("Neg"=GSEA_SUBNDown, "Pos"=GSEA_SUBNUp, .id="ID")
SUBN_plot$Y <- if_else(SUBN_plot$ID=="Neg", (SUBN_plot$Y * -1), (SUBN_plot$Y * 1))
SUBN_plot <- SUBN_plot %>% arrange(Y)
SUBN_gg <- ggplot(SUBN_plot, aes(x=Y, y=NES, fill=FDR)) + ylab("Normalized Enrichment Score") + xlab("") + themeset
SUBN_gg <- SUBN_gg + geom_col(color="black") +
labs(color='FDR q-value:') +
#scale_fill_gradientn(colors=mako(n=100, begin=0.71, end=0.15), limits=c(0,1)) +
scale_fill_gradientn(colors=plasma(n=100, begin=0.6, end=0), breaks=seq(0, 1, by=0.1)) +
scale_x_continuous(breaks=c(-5:-1,1:7), labels=SUBN_plot$NAME) +
scale_y_continuous(breaks=c(-1.5, -1, -0.5, 0, 0.5, 1, 1.5), limits=c(-1.5, 1.5)) +
ggtitle("GSEA Enrichment For SUB vs. N Trancription")
SUBN_gg + coord_flip()
SUBN_plot <- bind_rows("Neg"=GSEA_SUBNDown, "Pos"=GSEA_SUBNUp, .id="ID")
SUBN_plot$Y <- if_else(SUBN_plot$ID=="Neg", (SUBN_plot$Y * -1), (SUBN_plot$Y * 1))
SUBN_plot <- SUBN_plot %>% arrange(Y)
SUBN_gg <- ggplot(SUBN_plot, aes(x=Y, y=NES, fill=FDR)) + ylab("Normalized Enrichment Score") + xlab("") + themeset
SUBN_gg <- SUBN_gg + geom_col(color="black") +
labs(color='FDR q-value:') +
#scale_fill_gradientn(colors=mako(n=100, begin=0.71, end=0.15), limits=c(0,1)) +
scale_fill_gradientn(colors=plasma(n=100, begin=0.6, end=0), breaks=seq(0, 1, by=0.1)) +
scale_x_continuous(breaks=c(-5:-1,1:7), labels=SUBN_plot$NAME) +
scale_y_continuous(breaks=c(-2, -1.5, -1, -0.5, 0, 0.5, 1, 1.5, 2), limits=c(-2, 2)) +
ggtitle("GSEA Enrichment For SUB vs. N Trancription")
SUBN_gg + coord_flip()
library(tidyverse)
library(ggplot2)
library(ggrepel)
library(scales)
library(viridis)
library(cowplot)
colors_fill <- c("#38F2E0", "#1A74F8", "#F262F7", "#DA0054")
groupshapes <- c(19, 1, 15, 19, 1, 15, 17)
SUBN_plot <- bind_rows("Neg"=GSEA_SUBNDown, "Pos"=GSEA_SUBNUp, .id="ID")
SUBN_plot$Y <- if_else(SUBN_plot$ID=="Neg", (SUBN_plot$Y * -1), (SUBN_plot$Y * 1))
SUBN_plot <- SUBN_plot %>% arrange(Y)
SUBN_gg <- ggplot(SUBN_plot, aes(x=Y, y=NES, fill=FDR)) + ylab("Normalized Enrichment Score") + xlab("") + themeset
SUBN_gg <- SUBN_gg + geom_col(color="black") +
labs(color='FDR q-value:') +
#scale_fill_gradientn(colors=mako(n=100, begin=0.71, end=0.15), limits=c(0,1)) +
scale_fill_gradientn(colors=plasma(n=100, begin=0.6, end=0), breaks=seq(0, 1, by=0.1)) +
scale_x_continuous(breaks=c(-5:-1,1:7), labels=SUBN_plot$NAME) +
scale_y_continuous(breaks=c(-2, -1.5, -1, -0.5, 0, 0.5, 1, 1.5, 2), limits=c(-2, 2)) +
ggtitle("GSEA Enrichment For SUB vs. N Trancription")
SUBN_gg + coord_flip()
library(tidyverse)
library(ggplot2)
library(ggrepel)
library(scales)
library(viridis)
library(cowplot)
colors_fill <- c("#38F2E0", "#1A74F8", "#F262F7", "#DA0054")
groupshapes <- c(19, 1, 15, 19, 1, 15, 17)
#Plot NPP5N UNIQUE SCOTT TILS Up+Down Enrichment Curve
NPP5U_SCOTT_UP_EnrichData <- read_delim("EnrichmentCurveData/NPP5U_GSEA_Scott_TILS_Up.tsv")
ggplot(NPP5U_SCOTT_UP_EnrichData, aes(x=Rank, y=ES)) +
geom_line(color=colors_fill[2], lwd=2) +
geom_point(data=NPP5U_SCOTT_UP_EnrichData[which(NPP5U_SCOTT_UP_EnrichData$Plot=="TRUE"),], shape=21, fill="black", color="purple", size=4, stroke=1.2) +
geom_text_repel(data=NPP5U_SCOTT_UP_EnrichData[which(NPP5U_SCOTT_UP_EnrichData$Plot=="TRUE"),], aes(label=Symbol), size=6, nudge_x=100, nudge_y=-0.1, force=1.6, color=colors_fill[2], segment.size=1, segment.color="black") +
geom_hline(yintercept=0, lty="dotted", color="gray", size=1) +
xlab("Rank in Gene List") +
ylab("Enrichment Score") +
ggtitle("NPP5U Down in Exhaustion (Scott TILS)") +
themeset
NPP5U_SCOTT_DOWN_EnrichData <- read_delim("EnrichmentCurveData/NPP5U_GSEA_Scott_TILS_Dn.tsv")
ggplot(NPP5U_SCOTT_DOWN_EnrichData, aes(x=Rank, y=ES)) +
geom_line(color=colors_fill[2], lwd=2) +
geom_point(data=NPP5U_SCOTT_DOWN_EnrichData[which(NPP5U_SCOTT_DOWN_EnrichData$Plot=="TRUE"),], shape=21, fill="black", color="purple", size=4, stroke=1.2) +
geom_text_repel(data=NPP5U_SCOTT_DOWN_EnrichData[which(NPP5U_SCOTT_DOWN_EnrichData$Plot=="TRUE"),], aes(label=Symbol), size=6, nudge_x=100, nudge_y=-0.1, force=1.6, color=colors_fill[2], segment.size=1, segment.color="black") +
geom_hline(yintercept=0, lty="dotted", color="gray", size=1) +
xlab("Rank in Gene List") +
ylab("Enrichment Score") +
ggtitle("NPP5U Down in Exhaustion (Scott TILS)") +
themeset
#Plot SPP5SUB UNIQUE SCOTT TILS Up+Down Enrichment Curve
SPP5U_SCOTT_UP_EnrichData <- read_delim("EnrichmentCurveData/SPP5U_GSEA_Scott_TILS_Up.tsv")
ggplot(SPP5U_SCOTT_UP_EnrichData, aes(x=Rank, y=ES)) +
geom_line(color=colors_fill[4], lwd=2) +
geom_point(data=SPP5U_SCOTT_UP_EnrichData[which(SPP5U_SCOTT_UP_EnrichData$Plot=="TRUE"),], shape=21, fill="black", color="orange", size=4, stroke=1.2) +
geom_text_repel(data=SPP5U_SCOTT_UP_EnrichData[which(SPP5U_SCOTT_UP_EnrichData$Plot=="TRUE"),], aes(label=Symbol), size=6, nudge_x=100, nudge_y=-0.1, force=1.6, color=colors_fill[4], segment.size=1, segment.color="black") +
geom_hline(yintercept=0, lty="dotted", color="gray", size=1) +
xlab("Rank in Gene List") +
ylab("Enrichment Score") +
ggtitle("SPP5U Down in Exhaustion (Scott TILS)") +
themeset
SPP5U_SCOTT_DOWN_EnrichData <- read_delim("EnrichmentCurveData/SPP5U_GSEA_Scott_TILS_Dn.tsv")
ggplot(SPP5U_SCOTT_DOWN_EnrichData, aes(x=Rank, y=ES)) +
geom_line(color=colors_fill[4], lwd=2) +
geom_point(data=SPP5U_SCOTT_DOWN_EnrichData[which(SPP5U_SCOTT_DOWN_EnrichData$Plot=="TRUE"),], shape=21, fill="black", color="orange", size=4, stroke=1.2) +
geom_text_repel(data=SPP5U_SCOTT_DOWN_EnrichData[which(SPP5U_SCOTT_DOWN_EnrichData$Plot=="TRUE"),], aes(label=Symbol), size=6, nudge_x=100, nudge_y=-0.1, force=1.6, color=colors_fill[4], segment.size=1, segment.color="black") +
geom_hline(yintercept=0, lty="dotted", color="gray", size=1) +
xlab("Rank in Gene List") +
ylab("Enrichment Score") +
ggtitle("SPP5U Down in Exhaustion (Scott TILS)") +
themeset
NPP5U_Preg_UP_EnrichData <- read_delim("EnrichmentCurveData/NPP5U_GSEA_Preg_Up.tsv")
ggplot(NPP5U_Preg_UP_EnrichData, aes(x=Rank, y=ES)) +
geom_line(color=colors_fill[2], lwd=2) +
geom_point(data=NPP5U_Preg_UP_EnrichData[which(NPP5U_Preg_UP_EnrichData$Plot=="TRUE"),], shape=21, fill="black", color="purple", size=4, stroke=1.2) +
geom_text_repel(data=NPP5U_Preg_UP_EnrichData[which(NPP5U_Preg_UP_EnrichData$Plot=="TRUE"),], aes(label=Symbol), size=6, nudge_x=100, nudge_y=-0.1, force=1.6, color=colors_fill[2], segment.size=1, segment.color="black") +
geom_hline(yintercept=0, lty="dotted", color="gray", size=1) +
xlab("Rank in Gene List") +
ylab("Enrichment Score") +
ggtitle("NPP5U Up in Pregnancy") +
themeset
NPP5U_Preg_DOWN_EnrichData <- read_delim("EnrichmentCurveData/NPP5U_GSEA_Preg_Dn.tsv")
ggplot(NPP5U_Preg_DOWN_EnrichData, aes(x=Rank, y=ES)) +
geom_line(color=colors_fill[2], lwd=2) +
geom_point(data=NPP5U_Preg_DOWN_EnrichData[which(NPP5U_Preg_DOWN_EnrichData$Plot=="TRUE"),], shape=21, fill="black", color="purple", size=4, stroke=1.2) +
geom_text_repel(data=NPP5U_Preg_DOWN_EnrichData[which(NPP5U_Preg_DOWN_EnrichData$Plot=="TRUE"),], aes(label=Symbol), size=6, nudge_x=100, nudge_y=-0.1, force=1.6, color=colors_fill[2], segment.size=1, segment.color="black") +
geom_hline(yintercept=0, lty="dotted", color="gray", size=1) +
xlab("Rank in Gene List") +
ylab("Enrichment Score") +
ggtitle("NPP5U Down in Pregnancy") +
themeset
SPP5U_Preg_UP_EnrichData <- read_delim("EnrichmentCurveData/SPP5U_GSEA_Preg_Up.tsv")
ggplot(SPP5U_Preg_UP_EnrichData, aes(x=Rank, y=ES)) +
geom_line(color=colors_fill[4], lwd=2) +
geom_point(data=SPP5U_Preg_UP_EnrichData[which(SPP5U_Preg_UP_EnrichData$Plot=="TRUE"),], shape=21, fill="black", color="orange", size=4, stroke=1.2) +
geom_text_repel(data=SPP5U_Preg_UP_EnrichData[which(SPP5U_Preg_UP_EnrichData$Plot=="TRUE"),], aes(label=Symbol), size=6, nudge_x=100, nudge_y=-0.1, force=1.6, color=colors_fill[4], segment.size=1, segment.color="black") +
geom_hline(yintercept=0, lty="dotted", color="gray", size=1) +
xlab("Rank in Gene List") +
ylab("Enrichment Score") +
ggtitle("SPP5U Down in Pregnancy") +
themeset
SPP5U_Preg_DOWN_EnrichData <- read_delim("EnrichmentCurveData/SPP5U_GSEA_Preg_Dn.tsv")
ggplot(SPP5U_Preg_DOWN_EnrichData, aes(x=Rank, y=ES)) +
geom_line(color=colors_fill[4], lwd=2) +
geom_point(data=SPP5U_Preg_DOWN_EnrichData[which(SPP5U_Preg_DOWN_EnrichData$Plot=="TRUE"),], shape=21, fill="black", color="orange", size=4, stroke=1.2) +
geom_text_repel(data=SPP5U_Preg_DOWN_EnrichData[which(SPP5U_Preg_DOWN_EnrichData$Plot=="TRUE"),], aes(label=Symbol), size=6, nudge_x=100, nudge_y=-0.1, force=1.6, color=colors_fill[4], segment.size=1, segment.color="black") +
geom_hline(yintercept=0, lty="dotted", color="gray", size=1) +
xlab("Rank in Gene List") +
ylab("Enrichment Score") +
ggtitle("SPP5U Down in Pregnancy") +
themeset
Dev.off()
dev.off()
ggplot(NPP5U_SCOTT_UP_EnrichData, aes(x=Rank, y=ES)) +
geom_line(color=colors_fill[2], lwd=2) +
geom_point(data=NPP5U_SCOTT_UP_EnrichData[which(NPP5U_SCOTT_UP_EnrichData$Plot=="TRUE"),], shape=21, fill="black", color="purple", size=4, stroke=1.2) +
geom_text_repel(data=NPP5U_SCOTT_UP_EnrichData[which(NPP5U_SCOTT_UP_EnrichData$Plot=="TRUE"),], aes(label=Symbol), size=6, nudge_x=100, nudge_y=-0.1, force=1.6, color=colors_fill[2], segment.size=1, segment.color="black") +
geom_hline(yintercept=0, lty="dotted", color="gray", size=1) +
xlab("Rank in Gene List") +
ylab("Enrichment Score") +
ggtitle("NPP5U Up in Exhaustion (Scott TILS)") +
themeset
ggplot(NPP5U_SCOTT_DOWN_EnrichData, aes(x=Rank, y=ES)) +
geom_line(color=colors_fill[2], lwd=2) +
geom_point(data=NPP5U_SCOTT_DOWN_EnrichData[which(NPP5U_SCOTT_DOWN_EnrichData$Plot=="TRUE"),], shape=21, fill="black", color="purple", size=4, stroke=1.2) +
geom_text_repel(data=NPP5U_SCOTT_DOWN_EnrichData[which(NPP5U_SCOTT_DOWN_EnrichData$Plot=="TRUE"),], aes(label=Symbol), size=6, nudge_x=100, nudge_y=-0.1, force=1.6, color=colors_fill[2], segment.size=1, segment.color="black") +
geom_hline(yintercept=0, lty="dotted", color="gray", size=1) +
xlab("Rank in Gene List") +
ylab("Enrichment Score") +
ggtitle("NPP5U Down in Exhaustion (Scott TILS)") +
themeset
ggplot(SPP5U_SCOTT_UP_EnrichData, aes(x=Rank, y=ES)) +
geom_line(color=colors_fill[4], lwd=2) +
geom_point(data=SPP5U_SCOTT_UP_EnrichData[which(SPP5U_SCOTT_UP_EnrichData$Plot=="TRUE"),], shape=21, fill="black", color="orange", size=4, stroke=1.2) +
geom_text_repel(data=SPP5U_SCOTT_UP_EnrichData[which(SPP5U_SCOTT_UP_EnrichData$Plot=="TRUE"),], aes(label=Symbol), size=6, nudge_x=100, nudge_y=-0.1, force=1.6, color=colors_fill[4], segment.size=1, segment.color="black") +
geom_hline(yintercept=0, lty="dotted", color="gray", size=1) +
xlab("Rank in Gene List") +
ylab("Enrichment Score") +
ggtitle("SPP5U Down in Exhaustion (Scott TILS)") +
themeset
ggplot(SPP5U_SCOTT_DOWN_EnrichData, aes(x=Rank, y=ES)) +
geom_line(color=colors_fill[4], lwd=2) +
geom_point(data=SPP5U_SCOTT_DOWN_EnrichData[which(SPP5U_SCOTT_DOWN_EnrichData$Plot=="TRUE"),], shape=21, fill="black", color="orange", size=4, stroke=1.2) +
geom_text_repel(data=SPP5U_SCOTT_DOWN_EnrichData[which(SPP5U_SCOTT_DOWN_EnrichData$Plot=="TRUE"),], aes(label=Symbol), size=6, nudge_x=100, nudge_y=-0.1, force=1.6, color=colors_fill[4], segment.size=1, segment.color="black") +
geom_hline(yintercept=0, lty="dotted", color="gray", size=1) +
xlab("Rank in Gene List") +
ylab("Enrichment Score") +
ggtitle("SPP5U Down in Exhaustion (Scott TILS)") +
themeset
ggplot(NPP5U_Preg_UP_EnrichData, aes(x=Rank, y=ES)) +
geom_line(color=colors_fill[2], lwd=2) +
geom_point(data=NPP5U_Preg_UP_EnrichData[which(NPP5U_Preg_UP_EnrichData$Plot=="TRUE"),], shape=21, fill="black", color="purple", size=4, stroke=1.2) +
geom_text_repel(data=NPP5U_Preg_UP_EnrichData[which(NPP5U_Preg_UP_EnrichData$Plot=="TRUE"),], aes(label=Symbol), size=6, nudge_x=100, nudge_y=-0.1, force=1.6, color=colors_fill[2], segment.size=1, segment.color="black") +
geom_hline(yintercept=0, lty="dotted", color="gray", size=1) +
xlab("Rank in Gene List") +
ylab("Enrichment Score") +
ggtitle("NPP5U Up in Pregnancy") +
themeset
ggplot(NPP5U_Preg_DOWN_EnrichData, aes(x=Rank, y=ES)) +
geom_line(color=colors_fill[2], lwd=2) +
geom_point(data=NPP5U_Preg_DOWN_EnrichData[which(NPP5U_Preg_DOWN_EnrichData$Plot=="TRUE"),], shape=21, fill="black", color="purple", size=4, stroke=1.2) +
geom_text_repel(data=NPP5U_Preg_DOWN_EnrichData[which(NPP5U_Preg_DOWN_EnrichData$Plot=="TRUE"),], aes(label=Symbol), size=6, nudge_x=100, nudge_y=-0.1, force=1.6, color=colors_fill[2], segment.size=1, segment.color="black") +
geom_hline(yintercept=0, lty="dotted", color="gray", size=1) +
xlab("Rank in Gene List") +
ylab("Enrichment Score") +
ggtitle("NPP5U Down in Pregnancy") +
themeset
ggplot(SPP5U_Preg_UP_EnrichData, aes(x=Rank, y=ES)) +
geom_line(color=colors_fill[4], lwd=2) +
geom_point(data=SPP5U_Preg_UP_EnrichData[which(SPP5U_Preg_UP_EnrichData$Plot=="TRUE"),], shape=21, fill="black", color="orange", size=4, stroke=1.2) +
geom_text_repel(data=SPP5U_Preg_UP_EnrichData[which(SPP5U_Preg_UP_EnrichData$Plot=="TRUE"),], aes(label=Symbol), size=6, nudge_x=100, nudge_y=-0.1, force=1.6, color=colors_fill[4], segment.size=1, segment.color="black") +
geom_hline(yintercept=0, lty="dotted", color="gray", size=1) +
xlab("Rank in Gene List") +
ylab("Enrichment Score") +
ggtitle("SPP5U Down in Pregnancy") +
themeset
ggplot(SPP5U_Preg_DOWN_EnrichData, aes(x=Rank, y=ES)) +
geom_line(color=colors_fill[4], lwd=2) +
geom_point(data=SPP5U_Preg_DOWN_EnrichData[which(SPP5U_Preg_DOWN_EnrichData$Plot=="TRUE"),], shape=21, fill="black", color="orange", size=4, stroke=1.2) +
geom_text_repel(data=SPP5U_Preg_DOWN_EnrichData[which(SPP5U_Preg_DOWN_EnrichData$Plot=="TRUE"),], aes(label=Symbol), size=6, nudge_x=100, nudge_y=-0.1, force=1.6, color=colors_fill[4], segment.size=1, segment.color="black") +
geom_hline(yintercept=0, lty="dotted", color="gray", size=1) +
xlab("Rank in Gene List") +
ylab("Enrichment Score") +
ggtitle("SPP5U Down in Pregnancy") +
themeset
files <- list.files(path=filepath, pattern=".tsv")
#Unfiltered Pathways import (Select 10 most significant pathways, remove duplicates)
for(i in files){
objname <- str_replace(i, ".tsv", "")
dfin <- read.delim(str_c(filepath, "/", i, sep=""), header=TRUE, sep="\t")
dfin <- dfin %>% dplyr::select(c(NAME, NES, FDR)) %>%  arrange(desc(abs(NES)))
dfin <- dfin %>% mutate(Y=rev(row_number()))
assign(objname, dfin, envir = .GlobalEnv)
rm(dfin)
rm(i)
}
library(tidyverse)
library(ggplot2)
library(ggrepel)
library(scales)
library(viridis)
library(cowplot)
colors_fill <- c("#38F2E0", "#1A74F8", "#F262F7", "#DA0054")
groupshapes <- c(19, 1, 15, 19, 1, 15, 17)
#Unfiltered Pathways import (Select 10 most significant pathways, remove duplicates)
for(i in files){
objname <- str_replace(i, ".tsv", "")
dfin <- read.delim(str_c(filepath, "/", i, sep=""), header=TRUE, sep="\t")
dfin <- dfin %>% dplyr::select(c(NAME, NES, FDR)) %>%  arrange(desc(abs(NES)))
dfin <- dfin %>% mutate(Y=rev(row_number()))
assign(objname, dfin, envir = .GlobalEnv)
rm(dfin)
rm(i)
}
NPP5U_plot <- bind_rows("Neg"=GSEA_SPP5NPP5_NPP5U_UFNeg, "Pos"=GSEA_SPP5NPP5_NPP5U_UFPos, .id="ID")
NPP5U_plot$Y <- if_else(NPP5U_plot$ID=="Neg", (NPP5U_plot$Y * -1), (NPP5U_plot$Y * 1))
NPP5U_plot <- NPP5U_plot %>% arrange(Y)
NPP5U_gg <- ggplot(NPP5U_plot, aes(x=Y, y=NES, fill=FDR)) + ylab("Normalized Enrichment Score") + xlab("") + themeset
NPP5U_gg <- NPP5U_gg + geom_col(color="black") +
labs(color='FDR q-value:') +
#scale_fill_gradientn(colors=mako(n=100, begin=0.71, end=0.15), limits=c(0,1)) +
scale_fill_gradientn(colors=plasma(n=100, begin=0.8, end=0), breaks=seq(0, 1, by=0.1)) +
scale_x_continuous(breaks=c(-4:-1,1:9), labels=NPP5U_plot$NAME) +
scale_y_continuous(breaks=c(-2, -1.5, -1, -0.5, 0, 0.5, 1, 1.5, 2), limits=c(-2, 2)) +
ggtitle("GSEA Enrichment For Naive+Preg-Unique Trancription")
NPP5U_gg + coord_flip()
library(tidyverse)
library(ggplot2)
library(ggrepel)
library(scales)
library(viridis)
library(cowplot)
colors_fill <- c("#38F2E0", "#1A74F8", "#F262F7", "#DA0054")
groupshapes <- c(19, 1, 15, 19, 1, 15, 17)
SPP5U_gg + coord_flip()
Shared_gg + coord_flip()
Shared_gg <- Shared_gg + geom_col(color="black") +
labs(color='FDR q-value:') +
#scale_fill_gradientn(colors=mako(n=100, begin=0.71, end=0.15), limits=c(0,1)) +
scale_fill_gradientn(colors=plasma(n=100, begin=0.8, end=0), breaks=seq(0, 1, by=0.1)) +
scale_x_continuous(breaks=c(-4:-1,1:3), labels=Shared_plot$NAME) +
scale_y_continuous(breaks=c(-1.5, -1, -0.5, 0, 0.5, 1, 1.5), limits=c(-1.5, 1.5)) +
ggtitle("GSEA Enrichment For Shared Pregnancy Trancription")
Shared_gg + coord_flip()
Shared_gg <- ggplot(Shared_plot, aes(x=Y, y=NES, fill=FDR)) + ylab("Normalized Enrichment Score") + xlab("") + themeset
Shared_gg <- Shared_gg + geom_col(color="black") +
labs(color='FDR q-value:') +
#scale_fill_gradientn(colors=mako(n=100, begin=0.71, end=0.15), limits=c(0,1)) +
scale_fill_gradientn(colors=plasma(n=100, begin=0.8, end=0), breaks=seq(0, 1, by=0.1)) +
scale_x_continuous(breaks=c(-4:-1,1:3), labels=Shared_plot$NAME) +
scale_y_continuous(breaks=c(-1.5, -1, -0.5, 0, 0.5, 1, 1.5), limits=c(-1.5, 1.5)) +
ggtitle("GSEA Enrichment For Shared Pregnancy Trancription")
Shared_gg + coord_flip()
Shared_gg <- ggplot(Shared_plot, aes(x=Y, y=NES, fill=FDR)) + ylab("Normalized Enrichment Score") + xlab("") + themeset
Shared_gg <- Shared_gg + geom_col(color="black") +
labs(color='FDR q-value:') +
#scale_fill_gradientn(colors=mako(n=100, begin=0.71, end=0.15), limits=c(0,1)) +
scale_fill_gradientn(colors=plasma(n=100, begin=0.8, end=0), breaks=seq(0, 1, by=0.1), limits=c(0,1)) +
scale_x_continuous(breaks=c(-4:-1,1:3), labels=Shared_plot$NAME) +
scale_y_continuous(breaks=c(-1.5, -1, -0.5, 0, 0.5, 1, 1.5), limits=c(-1.5, 1.5)) +
ggtitle("GSEA Enrichment For Shared Pregnancy Trancription")
Shared_gg + coord_flip()
Shared_gg <- Shared_gg + geom_col(color="black") +
labs(color='FDR q-value:') +
#scale_fill_gradientn(colors=mako(n=100, begin=0.71, end=0.15), limits=c(0,1)) +
scale_fill_gradientn(colors=plasma(n=100, begin=0.8, end=0), breaks=seq(0, 1, by=0.2), limits=c(0,1)) +
scale_x_continuous(breaks=c(-4:-1,1:3), labels=Shared_plot$NAME) +
scale_y_continuous(breaks=c(-1.5, -1, -0.5, 0, 0.5, 1, 1.5), limits=c(-1.5, 1.5)) +
ggtitle("GSEA Enrichment For Shared Pregnancy Trancription")
Shared_gg + coord_flip()
NPP5U_gg + coord_flip()
NPP5U_gg <- ggplot(NPP5U_plot, aes(x=Y, y=NES, fill=FDR)) + ylab("Normalized Enrichment Score") + xlab("") + themeset
NPP5U_gg <- NPP5U_gg + geom_col(color="black") +
labs(color='FDR q-value:') +
#scale_fill_gradientn(colors=mako(n=100, begin=0.71, end=0.15), limits=c(0,1)) +
scale_fill_gradientn(colors=plasma(n=100, begin=0.8, end=0), breaks=seq(0, 1, by=0.1)) +
scale_x_continuous(breaks=c(-3:-1,1:6), labels=NPP5U_plot$NAME) +
scale_y_continuous(breaks=c(-2, -1.5, -1, -0.5, 0, 0.5, 1, 1.5, 2), limits=c(-2, 2)) +
ggtitle("GSEA Enrichment For Naive+Preg-Unique Trancription")
NPP5U_gg + coord_flip()
NPP5U_plot <- bind_rows("Neg"=GSEA_SPP5NPP5_NPP5U_Neg, "Pos"=GSEA_SPP5NPP5_NPP5U_Pos, .id="ID")
NPP5U_plot$Y <- if_else(NPP5U_plot$ID=="Neg", (NPP5U_plot$Y * -1), (NPP5U_plot$Y * 1))
NPP5U_plot <- NPP5U_plot %>% arrange(Y)
NPP5U_gg <- ggplot(NPP5U_plot, aes(x=Y, y=NES, fill=FDR)) + ylab("Normalized Enrichment Score") + xlab("") + themeset
NPP5U_gg <- NPP5U_gg + geom_col(color="black") +
labs(color='FDR q-value:') +
#scale_fill_gradientn(colors=mako(n=100, begin=0.71, end=0.15), limits=c(0,1)) +
scale_fill_gradientn(colors=plasma(n=100, begin=0.8, end=0), breaks=seq(0, 1, by=0.1)) +
scale_x_continuous(breaks=c(-3:-1,1:6), labels=NPP5U_plot$NAME) +
scale_y_continuous(breaks=c(-2, -1.5, -1, -0.5, 0, 0.5, 1, 1.5, 2), limits=c(-2, 2)) +
ggtitle("GSEA Enrichment For Naive+Preg-Unique Trancription")
NPP5U_gg + coord_flip()
NPP5U_plot <- bind_rows("Neg"=GSEA_SPP5NPP5_NPP5U_UFNeg, "Pos"=GSEA_SPP5NPP5_NPP5U_UFPos, .id="ID")
NPP5U_plot$Y <- if_else(NPP5U_plot$ID=="Neg", (NPP5U_plot$Y * -1), (NPP5U_plot$Y * 1))
NPP5U_plot <- NPP5U_plot %>% arrange(Y)
NPP5U_gg <- ggplot(NPP5U_plot, aes(x=Y, y=NES, fill=FDR)) + ylab("Normalized Enrichment Score") + xlab("") + themeset
NPP5U_gg <- NPP5U_gg + geom_col(color="black") +
labs(color='FDR q-value:') +
#scale_fill_gradientn(colors=mako(n=100, begin=0.71, end=0.15), limits=c(0,1)) +
scale_fill_gradientn(colors=plasma(n=100, begin=0.8, end=0), breaks=seq(0, 1, by=0.1)) +
scale_x_continuous(breaks=c(-4:-1,1:9), labels=NPP5U_plot$NAME) +
scale_y_continuous(breaks=c(-2, -1.5, -1, -0.5, 0, 0.5, 1, 1.5, 2), limits=c(-2, 2)) +
ggtitle("GSEA Enrichment For Naive+Preg-Unique Trancription")
NPP5U_gg + coord_flip()
Shared_plot <- bind_rows("Neg"=GSEA_SPP5NPP5Shared_Neg, "Pos"=GSEA_SPP5NPP5Shared_Pos, .id="ID")
Shared_plot$Y <- if_else(Shared_plot$ID=="Neg", (Shared_plot$Y * -1), (Shared_plot$Y * 1))
Shared_plot <- Shared_plot %>% arrange(Y)
Shared_gg <- ggplot(Shared_plot, aes(x=Y, y=NES, fill=FDR)) + ylab("Normalized Enrichment Score") + xlab("") + themeset
Shared_gg <- Shared_gg + geom_col(color="black") +
labs(color='FDR q-value:') +
#scale_fill_gradientn(colors=mako(n=100, begin=0.71, end=0.15), limits=c(0,1)) +
scale_fill_gradientn(colors=plasma(n=100, begin=0.8, end=0), breaks=seq(0, 1, by=0.2), limits=c(0,1)) +
scale_x_continuous(breaks=c(-4:-1,1:3), labels=Shared_plot$NAME) +
scale_y_continuous(breaks=c(-1.5, -1, -0.5, 0, 0.5, 1, 1.5), limits=c(-1.5, 1.5)) +
ggtitle("GSEA Enrichment For Shared Pregnancy Trancription")
Shared_gg + coord_flip()
library(tidyverse)
library(ggplot2)
library(ggrepel)
library(scales)
library(viridis)
library(cowplot)
colors_fill <- c("#38F2E0", "#1A74F8", "#F262F7", "#DA0054")
groupshapes <- c(19, 1, 15, 19, 1, 15, 17)
NPP5U_gg + coord_flip()
Shared_gg + coord_flip()
NPP5U_gg + coord_flip()
library(tidyverse)
library(ggplot2)
library(ggrepel)
library(scales)
library(viridis)
library(cowplot)
colors_fill <- c("#38F2E0", "#1A74F8", "#F262F7", "#DA0054")
groupshapes <- c(19, 1, 15, 19, 1, 15, 17)
NPP5U_gg + coord_flip()
SPP5U_gg + coord_flip()
