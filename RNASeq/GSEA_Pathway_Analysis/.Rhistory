SPP5NPP5_NPP5U_gg <- ggplot(SPP5NPP5_NPP5U_plot, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
SPP5NPP5_NPP5U_gg <- SPP5NPP5_NPP5U_gg + geom_point(aes(size=Enrichment, color=ID, shape=ID)) +
labs(color='Naive+PP C5 Unique Pathways:', shape='Naive+PP C5 Unique Pathways:') +
#scale_color_manual(values=c(colors_fill[1], colors_fill[2])) +
scale_shape_manual(values=c(groupshapes[3], groupshapes[3])) +
scale_y_continuous(breaks=c(-6:-1,1:12), labels=SPP5NPP5_NPP5U_plot$Description) +
scale_x_continuous(breaks=c(-10, -5, 0, 5, 10), labels=abs(c(-10, -5, 0, 5, 10)), limits=c(-10,10)) +
ggtitle("Pathways Present in Unique NPP-C5 Transcription")
SPP5NPP5_NPP5U_gg
files_Shared_Filtered <- list.files(path=filepath_Shared, pattern="_F.csv")
for(i in files_Shared_Filtered){
objname <- str_replace(i, "_F.csv", "_Filtered")
dfin <- read.csv(str_c(filepath_Shared, "/", i, sep=""), header=TRUE)
dfin <- dfin %>% mutate(Sig=1-LogP) %>% dplyr::select(Description, Sig, Enrichment) %>%  arrange(desc(Sig))
dfin$Description <- firstup(dfin$Description)
dfin <- dfin %>%  mutate(Y=rev(row_number()))
assign(objname, dfin, envir = .GlobalEnv)
rm(dfin)
rm(i)
}
SPP5NPP5_SPP5U_plot <- bind_rows("Downregulated"=SPP5NPP5_SPP5U_Down_Filtered, "Upregulated"=SPP5NPP5_SPP5U_Up_Filtered, .id="ID")
SPP5NPP5_SPP5U_plot$Sig <- if_else(SPP5NPP5_SPP5U_plot$ID=="Downregulated", (SPP5NPP5_SPP5U_plot$Sig * -1), (SPP5NPP5_SPP5U_plot$Sig * 1))
SPP5NPP5_SPP5U_plot$Y <- if_else(SPP5NPP5_SPP5U_plot$ID=="Downregulated", (SPP5NPP5_SPP5U_plot$Y * -1), (SPP5NPP5_SPP5U_plot$Y * 1))
SPP5NPP5_NPP5U_gg <- ggplot(SPP5NPP5_NPP5U_plot, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
SPP5NPP5_NPP5U_gg <- SPP5NPP5_NPP5U_gg + geom_point(aes(size=Enrichment, color=ID, shape=ID)) +
labs(color='Naive+PP C5 Unique Pathways:', shape='Naive+PP C5 Unique Pathways:') +
#scale_color_manual(values=c(colors_fill[1], colors_fill[2])) +
scale_shape_manual(values=c(groupshapes[3], groupshapes[3])) +
scale_y_continuous(breaks=c(-6:-1,1:12), labels=SPP5NPP5_NPP5U_plot$Description) +
scale_x_continuous(breaks=c(-10, -5, 0, 5, 10), labels=abs(c(-10, -5, 0, 5, 10)), limits=c(-10,10)) +
ggtitle("Pathways Present in Unique Naive+PP-C5 Transcription")
SPP5NPP5_NPP5U_gg
View(SPP5NPP5_SPP5U_plot)
SPP5NPP5_SPP5U_plot <- bind_rows("Downregulated"=SPP5NPP5_SPP5U_Down_Filtered, "Upregulated"=SPP5NPP5_SPP5U_Up_Filtered, .id="ID")
SPP5NPP5_SPP5U_plot$Sig <- if_else(SPP5NPP5_SPP5U_plot$ID=="Downregulated", (SPP5NPP5_SPP5U_plot$Sig * -1), (SPP5NPP5_SPP5U_plot$Sig * 1))
SPP5NPP5_SPP5U_plot$Y <- if_else(SPP5NPP5_SPP5U_plot$ID=="Downregulated", (SPP5NPP5_SPP5U_plot$Y * -1), (SPP5NPP5_SPP5U_plot$Y * 1))
SPP5NPP5_SPP5U_plot <- SPP5NPP5_SPP5U_plot %>% arrange(Y)
#SPP5NPP5_SPP5U_plot$Description <- SPP5NPP5_SPP5U_plot$Description %>% str_replace("receptor superfamily \\(TNFSF\\) members" , "superfamily")
SPP5NPP5_SPP5U_gg <- ggplot(SPP5NPP5_SPP5U_plot, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
SPP5NPP5_SPP5U_gg <- SPP5NPP5_SPP5U_gg + geom_point(aes(size=Enrichment, color=ID, shape=ID)) +
labs(color='Naive+PP C5 Unique Pathways:', shape='Naive+PP C5 Unique Pathways:') +
#scale_color_manual(values=c(colors_fill[1], colors_fill[2])) +
scale_shape_manual(values=c(groupshapes[3], groupshapes[3])) +
scale_y_continuous(breaks=c(-11:-1,1:12), labels=SPP5NPP5_SPP5U_plot$Description) +
scale_x_continuous(breaks=c(-6, -4, -2, 0, 2, 4, 6), labels=abs(c(-6, -4, -2, 0, 2, 4, 6)), limits=c(-6,6)) +
ggtitle("Pathways Present in Unique Sens+PP-C5 Transcription")
SPP5NPP5_SPP5U_gg
View(SPP5NPP5_SPP5U_plot)
SPP5NPP5_SPP5U_plot <- bind_rows("Downregulated"=SPP5NPP5_SPP5U_Down_Filtered, "Upregulated"=SPP5NPP5_SPP5U_Up_Filtered, .id="ID")
SPP5NPP5_SPP5U_plot$Sig <- if_else(SPP5NPP5_SPP5U_plot$ID=="Downregulated", (SPP5NPP5_SPP5U_plot$Sig * -1), (SPP5NPP5_SPP5U_plot$Sig * 1))
SPP5NPP5_SPP5U_plot$Y <- if_else(SPP5NPP5_SPP5U_plot$ID=="Downregulated", (SPP5NPP5_SPP5U_plot$Y * -1), (SPP5NPP5_SPP5U_plot$Y * 1))
SPP5NPP5_SPP5U_plot <- SPP5NPP5_SPP5U_plot %>% arrange(Y)
#SPP5NPP5_SPP5U_plot$Description <- SPP5NPP5_SPP5U_plot$Description %>% str_replace("receptor superfamily \\(TNFSF\\) members" , "superfamily")
SPP5NPP5_SPP5U_gg <- ggplot(SPP5NPP5_SPP5U_plot, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
SPP5NPP5_SPP5U_gg <- SPP5NPP5_SPP5U_gg + geom_point(aes(size=Enrichment, color=ID, shape=ID)) +
labs(color='Naive+PP C5 Unique Pathways:', shape='Naive+PP C5 Unique Pathways:') +
#scale_color_manual(values=c(colors_fill[1], colors_fill[2])) +
scale_shape_manual(values=c(groupshapes[3], groupshapes[3])) +
scale_y_continuous(breaks=c(-11:-1,1:12), labels=SPP5NPP5_SPP5U_plot$Description) +
scale_x_continuous(breaks=c(-6, -4, -2, 0, 2, 4, 6), labels=abs(c(-6, -4, -2, 0, 2, 4, 6)), limits=c(-6,7)) +
ggtitle("Pathways Present in Unique Sens+PP-C5 Transcription")
SPP5NPP5_SPP5U_gg
SPP5NPP5_SPP5U_plot <- bind_rows("Downregulated"=SPP5NPP5_SPP5U_Down_Filtered, "Upregulated"=SPP5NPP5_SPP5U_Up_Filtered, .id="ID")
SPP5NPP5_SPP5U_plot$Sig <- if_else(SPP5NPP5_SPP5U_plot$ID=="Downregulated", (SPP5NPP5_SPP5U_plot$Sig * -1), (SPP5NPP5_SPP5U_plot$Sig * 1))
SPP5NPP5_SPP5U_plot$Y <- if_else(SPP5NPP5_SPP5U_plot$ID=="Downregulated", (SPP5NPP5_SPP5U_plot$Y * -1), (SPP5NPP5_SPP5U_plot$Y * 1))
SPP5NPP5_SPP5U_plot <- SPP5NPP5_SPP5U_plot %>% arrange(Y)
#SPP5NPP5_SPP5U_plot$Description <- SPP5NPP5_SPP5U_plot$Description %>% str_replace("receptor superfamily \\(TNFSF\\) members" , "superfamily")
SPP5NPP5_SPP5U_gg <- ggplot(SPP5NPP5_SPP5U_plot, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
SPP5NPP5_SPP5U_gg <- SPP5NPP5_SPP5U_gg + geom_point(aes(size=Enrichment, color=ID, shape=ID)) +
labs(color='Naive+PP C5 Unique Pathways:', shape='Naive+PP C5 Unique Pathways:') +
#scale_color_manual(values=c(colors_fill[1], colors_fill[2])) +
scale_shape_manual(values=c(groupshapes[3], groupshapes[3])) +
scale_y_continuous(breaks=c(-11:-1,1:12), labels=SPP5NPP5_SPP5U_plot$Description) +
scale_x_continuous(breaks=c(-8, -6, -4, -2, 0, 2, 4, 6, 8), labels=abs(c(-8, -6, -4, -2, 0, 2, 4, 6, 8)), limits=c(-8,8)) +
ggtitle("Pathways Present in Unique Sens+PP-C5 Transcription")
SPP5NPP5_SPP5U_gg
SPP5NPP5_SPP5U_plot <- bind_rows("Downregulated"=SPP5NPP5_SPP5U_Down_Filtered, "Upregulated"=SPP5NPP5_SPP5U_Up_Filtered, .id="ID")
SPP5NPP5_SPP5U_plot$Sig <- if_else(SPP5NPP5_SPP5U_plot$ID=="Downregulated", (SPP5NPP5_SPP5U_plot$Sig * -1), (SPP5NPP5_SPP5U_plot$Sig * 1))
SPP5NPP5_SPP5U_plot$Y <- if_else(SPP5NPP5_SPP5U_plot$ID=="Downregulated", (SPP5NPP5_SPP5U_plot$Y * -1), (SPP5NPP5_SPP5U_plot$Y * 1))
SPP5NPP5_SPP5U_plot <- SPP5NPP5_SPP5U_plot %>% arrange(Y)
#SPP5NPP5_SPP5U_plot$Description <- SPP5NPP5_SPP5U_plot$Description %>% str_replace("receptor superfamily \\(TNFSF\\) members" , "superfamily")
SPP5NPP5_SPP5U_gg <- ggplot(SPP5NPP5_SPP5U_plot, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
SPP5NPP5_SPP5U_gg <- SPP5NPP5_SPP5U_gg + geom_point(aes(size=Enrichment, color=ID, shape=ID)) +
labs(color='Naive+PP C5 Unique Pathways:', shape='Naive+PP C5 Unique Pathways:') +
#scale_color_manual(values=c(colors_fill[1], colors_fill[2])) +
scale_shape_manual(values=c(groupshapes[3], groupshapes[3])) +
scale_y_continuous(breaks=c(-11:-1,1:12), labels=SPP5NPP5_SPP5U_plot$Description) +
scale_x_continuous(breaks=c(-8, -6, -4, -2, 0, 2, 4, 6, 8), labels=abs(c(-8, -6, -4, -2, 0, 2, 4, 6, 8)), limits=c(-8,8)) +
ggtitle("Pathways Present in Unique Sens+PP-C5 Transcription") +
theme(axis.text.y = element_text(color = "black", size = 14.5))
SPP5NPP5_SPP5U_gg
filepath_Shared <- "./Metascape_SharedUnique/GOcharts"
files_Shared_Filtered <- list.files(path=filepath_Shared, pattern="_F.csv")
for(i in files_Shared_Filtered){
objname <- str_replace(i, "_F.csv", "_Filtered")
dfin <- read.csv(str_c(filepath_Shared, "/", i, sep=""), header=TRUE)
dfin <- dfin %>% mutate(Sig=1-LogP) %>% dplyr::select(Description, Sig, Enrichment) %>%  arrange(desc(Sig))
dfin$Description <- firstup(dfin$Description)
dfin <- dfin %>%  mutate(Y=rev(row_number()))
assign(objname, dfin, envir = .GlobalEnv)
rm(dfin)
rm(i)
}
library(tidyverse)
library(ggplot2)
library(scales)
library(viridis)
library(cowplot)
for(i in files_Shared_Filtered){
objname <- str_replace(i, "_F.csv", "_Filtered")
dfin <- read.csv(str_c(filepath_Shared, "/", i, sep=""), header=TRUE)
dfin <- dfin %>% mutate(Sig=1-LogP) %>% dplyr::select(Description, Sig, Enrichment) %>%  arrange(desc(Sig))
dfin$Description <- firstup(dfin$Description)
dfin <- dfin %>%  mutate(Y=rev(row_number()))
assign(objname, dfin, envir = .GlobalEnv)
rm(dfin)
rm(i)
}
SPP5NPP5_SharedUp_plot <- SPP5NPP5_SharedUp_Filtered
SPP5NPP5_SharedUp_plot <- SPP5NPP5_SharedUp_plot %>% arrange(Y)
SPP5NPP5_SharedUp_gg <- ggplot(SPP5NPP5_SharedUp_plot, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
SPP5NPP5_SharedUp_gg <- SPP5NPP5_SharedUp_gg + geom_point(aes(size=Enrichment, color=Sig), shape=groupshapes[3]) +
labs(color='-log(P-value)') +
scale_y_continuous(breaks=c(1:9), labels=SPP5NPP5_SharedUp_plot$Description) +
scale_x_continuous(breaks=c(0, 3, 6, 9, 12), limits=c(0,12)) +
scale_color_gradientn(colors=turbo(n=100, begin=0.1, end=0.8)) +
#scale_color_gradient(low=turbo(n=1, begin=0.15), high=turbo(n=1, begin=0.85)) +
ggtitle("Pathways Present in Shared Pregnancy Transcription")
SPP5NPP5_SharedUp_gg
for(i in files_Shared_Filtered){
objname <- str_replace(i, "_F.csv", "_Filtered")
dfin <- read.csv(str_c(filepath_Shared, "/", i, sep=""), header=TRUE)
dfin <- dfin %>% mutate(Sig=1-LogP) %>% dplyr::select(Description, Sig, Enrichment) %>%  arrange(desc(Sig))
dfin$Description <- firstup(dfin$Description)
dfin <- dfin %>%  mutate(Y=rev(row_number()))
assign(objname, dfin, envir = .GlobalEnv)
rm(dfin)
rm(i)
}
SPP5NPP5_SharedUp_plot <- SPP5NPP5_SharedUp_Filtered
SPP5NPP5_SharedUp_plot <- SPP5NPP5_SharedUp_plot %>% arrange(Y)
SPP5NPP5_SharedUp_gg <- ggplot(SPP5NPP5_SharedUp_plot, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
SPP5NPP5_SharedUp_gg <- SPP5NPP5_SharedUp_gg + geom_point(aes(size=Enrichment, color=Sig), shape=groupshapes[3]) +
labs(color='-log(P-value)') +
scale_y_continuous(breaks=c(1:9), labels=SPP5NPP5_SharedUp_plot$Description) +
scale_x_continuous(breaks=c(0, 3, 6, 9, 12), limits=c(0,12)) +
scale_color_gradientn(colors=turbo(n=100, begin=0.1, end=0.8)) +
#scale_color_gradient(low=turbo(n=1, begin=0.15), high=turbo(n=1, begin=0.85)) +
ggtitle("Pathways Present in Shared Pregnancy Transcription")
SPP5NPP5_SharedUp_gg
for(i in files_Shared_Filtered){
objname <- str_replace(i, "_F.csv", "_Filtered")
dfin <- read.csv(str_c(filepath_Shared, "/", i, sep=""), header=TRUE)
dfin <- dfin %>% mutate(Sig=1-LogP) %>% dplyr::select(Description, Sig, Enrichment) %>%  arrange(desc(Sig))
dfin$Description <- firstup(dfin$Description)
dfin <- dfin %>%  mutate(Y=rev(row_number()))
assign(objname, dfin, envir = .GlobalEnv)
rm(dfin)
rm(i)
}
SPP5NPP5_SharedUp_plot <- SPP5NPP5_SharedUp_Filtered
SPP5NPP5_SharedUp_plot <- SPP5NPP5_SharedUp_plot %>% arrange(Y)
SPP5NPP5_SharedUp_gg <- ggplot(SPP5NPP5_SharedUp_plot, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
SPP5NPP5_SharedUp_gg <- SPP5NPP5_SharedUp_gg + geom_point(aes(size=Enrichment, color=Sig), shape=groupshapes[3]) +
labs(color='-log(P-value)') +
scale_y_continuous(breaks=c(1:9), labels=SPP5NPP5_SharedUp_plot$Description) +
scale_x_continuous(breaks=c(0, 3, 6, 9, 12), limits=c(0,12)) +
scale_color_gradientn(colors=turbo(n=100, begin=0.1, end=0.8)) +
#scale_color_gradient(low=turbo(n=1, begin=0.15), high=turbo(n=1, begin=0.85)) +
ggtitle("Pathways Present in Shared Pregnancy Transcription")
SPP5NPP5_SharedUp_gg
SPP5NPP5_NPP5U_plot <- bind_rows("Downregulated"=SPP5NPP5_NPP5U_Down_Filtered, "Upregulated"=SPP5NPP5_NPP5U_Up_Filtered, .id="ID")
SPP5NPP5_NPP5U_plot$Sig <- if_else(SPP5NPP5_NPP5U_plot$ID=="Downregulated", (SPP5NPP5_NPP5U_plot$Sig * -1), (SPP5NPP5_NPP5U_plot$Sig * 1))
SPP5NPP5_NPP5U_plot$Y <- if_else(SPP5NPP5_NPP5U_plot$ID=="Downregulated", (SPP5NPP5_NPP5U_plot$Y * -1), (SPP5NPP5_NPP5U_plot$Y * 1))
SPP5NPP5_NPP5U_plot <- SPP5NPP5_NPP5U_plot %>% arrange(Y)
SPP5NPP5_NPP5U_plot$Description <- SPP5NPP5_NPP5U_plot$Description %>% str_replace("receptor superfamily \\(TNFSF\\) members" , "superfamily")
SPP5NPP5_NPP5U_gg <- ggplot(SPP5NPP5_NPP5U_plot, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
SPP5NPP5_NPP5U_gg <- SPP5NPP5_NPP5U_gg + geom_point(aes(size=Enrichment, color=ID, shape=ID)) +
labs(color='Naive+PP C5 Unique Pathways:', shape='Naive+PP C5 Unique Pathways:') +
#scale_color_manual(values=c(colors_fill[1], colors_fill[2])) +
scale_shape_manual(values=c(groupshapes[3], groupshapes[3])) +
scale_y_continuous(breaks=c(-4:-1,1:9), labels=SPP5NPP5_NPP5U_plot$Description) +
scale_x_continuous(breaks=c(-10, -5, 0, 5, 10), labels=abs(c(-10, -5, 0, 5, 10)), limits=c(-10,10)) +
ggtitle("Pathways Present in Unique Naive+PP-C5 Transcription")
SPP5NPP5_NPP5U_gg
View(SPP5NPP5_NPP5U_plot)
SPP5NPP5_NPP5U_plot <- bind_rows("Downregulated"=SPP5NPP5_NPP5U_Down_Filtered, "Upregulated"=SPP5NPP5_NPP5U_Up_Filtered, .id="ID")
SPP5NPP5_NPP5U_plot$Sig <- if_else(SPP5NPP5_NPP5U_plot$ID=="Downregulated", (SPP5NPP5_NPP5U_plot$Sig * -1), (SPP5NPP5_NPP5U_plot$Sig * 1))
SPP5NPP5_NPP5U_plot$Y <- if_else(SPP5NPP5_NPP5U_plot$ID=="Downregulated", (SPP5NPP5_NPP5U_plot$Y * -1), (SPP5NPP5_NPP5U_plot$Y * 1))
SPP5NPP5_NPP5U_plot <- SPP5NPP5_NPP5U_plot %>% arrange(Y)
SPP5NPP5_NPP5U_plot$Description <- SPP5NPP5_NPP5U_plot$Description %>% str_replace("receptor superfamily \\(TNFSF\\) members" , "superfamily")
SPP5NPP5_NPP5U_gg <- ggplot(SPP5NPP5_NPP5U_plot, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
SPP5NPP5_NPP5U_gg <- SPP5NPP5_NPP5U_gg + geom_point(aes(size=Enrichment, color=ID, shape=ID)) +
labs(color='Naive+PP C5 Unique Pathways:', shape='Naive+PP C5 Unique Pathways:') +
#scale_color_manual(values=c(colors_fill[1], colors_fill[2])) +
scale_shape_manual(values=c(groupshapes[3], groupshapes[3])) +
scale_y_continuous(breaks=c(-4:-1,1:8), labels=SPP5NPP5_NPP5U_plot$Description) +
scale_x_continuous(breaks=c(-10, -5, 0, 5, 10), labels=abs(c(-10, -5, 0, 5, 10)), limits=c(-10,10)) +
ggtitle("Pathways Present in Unique Naive+PP-C5 Transcription")
SPP5NPP5_NPP5U_gg
SPP5NPP5_SPP5U_plot <- bind_rows("Downregulated"=SPP5NPP5_SPP5U_Down_Filtered, "Upregulated"=SPP5NPP5_SPP5U_Up_Filtered, .id="ID")
SPP5NPP5_SPP5U_plot$Sig <- if_else(SPP5NPP5_SPP5U_plot$ID=="Downregulated", (SPP5NPP5_SPP5U_plot$Sig * -1), (SPP5NPP5_SPP5U_plot$Sig * 1))
SPP5NPP5_SPP5U_plot$Y <- if_else(SPP5NPP5_SPP5U_plot$ID=="Downregulated", (SPP5NPP5_SPP5U_plot$Y * -1), (SPP5NPP5_SPP5U_plot$Y * 1))
SPP5NPP5_SPP5U_plot <- SPP5NPP5_SPP5U_plot %>% arrange(Y)
#SPP5NPP5_SPP5U_plot$Description <- SPP5NPP5_SPP5U_plot$Description %>% str_replace("receptor superfamily \\(TNFSF\\) members" , "superfamily")
SPP5NPP5_SPP5U_gg <- ggplot(SPP5NPP5_SPP5U_plot, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
SPP5NPP5_SPP5U_gg <- SPP5NPP5_SPP5U_gg + geom_point(aes(size=Enrichment, color=ID, shape=ID)) +
labs(color='Naive+PP C5 Unique Pathways:', shape='Naive+PP C5 Unique Pathways:') +
#scale_color_manual(values=c(colors_fill[1], colors_fill[2])) +
scale_shape_manual(values=c(groupshapes[3], groupshapes[3])) +
scale_y_continuous(breaks=c(-8:-1,1:9), labels=SPP5NPP5_SPP5U_plot$Description) +
scale_x_continuous(breaks=c(-8, -6, -4, -2, 0, 2, 4, 6, 8), labels=abs(c(-8, -6, -4, -2, 0, 2, 4, 6, 8)), limits=c(-8,8)) +
ggtitle("Pathways Present in Unique Sens+PP-C5 Transcription") +
theme(axis.text.y = element_text(color = "black", size = 14.5))
SPP5NPP5_SPP5U_gg
filepath_UD <- "./Metascape_UD/GOcharts"
filepath_Shared <- "./Metascape_SharedUnique/GOcharts"
files_UD <- list.files(path=filepath_UD, pattern=".csv")
files_UD_Filtered <- list.files(path=filepath_UD, pattern="_F.csv")
files_Shared_Filtered <- list.files(path=filepath_Shared, pattern="_F.csv")
for(i in files_Shared_Filtered){
objname <- str_replace(i, "_F.csv", "_Filtered")
dfin <- read.csv(str_c(filepath_Shared, "/", i, sep=""), header=TRUE)
dfin <- dfin %>% mutate(Sig=1-LogP) %>% dplyr::select(Description, Sig, Enrichment) %>%  arrange(desc(Sig))
dfin$Description <- firstup(dfin$Description)
dfin <- dfin %>%  mutate(Y=rev(row_number()))
assign(objname, dfin, envir = .GlobalEnv)
rm(dfin)
rm(i)
}
library(tidyverse)
library(ggplot2)
library(scales)
library(viridis)
library(cowplot)
colors_fill <- c("#38F2E0", "#1A74F8", "#F262F7", "#DA0054")
groupshapes <- c(19, 1, 15, 19, 1, 15, 17)
for(i in files_Shared_Filtered){
objname <- str_replace(i, "_F.csv", "_Filtered")
dfin <- read.csv(str_c(filepath_Shared, "/", i, sep=""), header=TRUE)
dfin <- dfin %>% mutate(Sig=1-LogP) %>% dplyr::select(Description, Sig, Enrichment) %>%  arrange(desc(Sig))
dfin$Description <- firstup(dfin$Description)
dfin <- dfin %>%  mutate(Y=rev(row_number()))
assign(objname, dfin, envir = .GlobalEnv)
rm(dfin)
rm(i)
}
SPP5NPP5_SPP5U_plot <- bind_rows("Downregulated"=SPP5NPP5_SPP5U_Down_Filtered, "Upregulated"=SPP5NPP5_SPP5U_Up_Filtered, .id="ID")
SPP5NPP5_SPP5U_plot$Sig <- if_else(SPP5NPP5_SPP5U_plot$ID=="Downregulated", (SPP5NPP5_SPP5U_plot$Sig * -1), (SPP5NPP5_SPP5U_plot$Sig * 1))
SPP5NPP5_SPP5U_plot$Y <- if_else(SPP5NPP5_SPP5U_plot$ID=="Downregulated", (SPP5NPP5_SPP5U_plot$Y * -1), (SPP5NPP5_SPP5U_plot$Y * 1))
SPP5NPP5_SPP5U_plot <- SPP5NPP5_SPP5U_plot %>% arrange(Y)
#SPP5NPP5_SPP5U_plot$Description <- SPP5NPP5_SPP5U_plot$Description %>% str_replace("receptor superfamily \\(TNFSF\\) members" , "superfamily")
SPP5NPP5_SPP5U_gg <- ggplot(SPP5NPP5_SPP5U_plot, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
SPP5NPP5_SPP5U_gg <- SPP5NPP5_SPP5U_gg + geom_point(aes(size=Enrichment, color=ID, shape=ID)) +
labs(color='Naive+PP C5 Unique Pathways:', shape='Naive+PP C5 Unique Pathways:') +
#scale_color_manual(values=c(colors_fill[1], colors_fill[2])) +
scale_shape_manual(values=c(groupshapes[3], groupshapes[3])) +
scale_y_continuous(breaks=c(-8:-1,1:9), labels=SPP5NPP5_SPP5U_plot$Description) +
scale_x_continuous(breaks=c(-8, -6, -4, -2, 0, 2, 4, 6, 8), labels=abs(c(-8, -6, -4, -2, 0, 2, 4, 6, 8)), limits=c(-8,8)) +
ggtitle("Pathways Present in Unique Sens+PP-C5 Transcription") +
theme(axis.text.y = element_text(color = "black", size = 14.5))
SPP5NPP5_SPP5U_gg
SPP5NPP5_SPP5U_plot <- bind_rows("Downregulated"=SPP5NPP5_SPP5U_Down_Filtered, "Upregulated"=SPP5NPP5_SPP5U_Up_Filtered, .id="ID")
SPP5NPP5_SPP5U_plot$Sig <- if_else(SPP5NPP5_SPP5U_plot$ID=="Downregulated", (SPP5NPP5_SPP5U_plot$Sig * -1), (SPP5NPP5_SPP5U_plot$Sig * 1))
SPP5NPP5_SPP5U_plot$Y <- if_else(SPP5NPP5_SPP5U_plot$ID=="Downregulated", (SPP5NPP5_SPP5U_plot$Y * -1), (SPP5NPP5_SPP5U_plot$Y * 1))
SPP5NPP5_SPP5U_plot <- SPP5NPP5_SPP5U_plot %>% arrange(Y)
#SPP5NPP5_SPP5U_plot$Description <- SPP5NPP5_SPP5U_plot$Description %>% str_replace("receptor superfamily \\(TNFSF\\) members" , "superfamily")
SPP5NPP5_SPP5U_gg <- ggplot(SPP5NPP5_SPP5U_plot, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
SPP5NPP5_SPP5U_gg <- SPP5NPP5_SPP5U_gg + geom_point(aes(size=Enrichment, color=ID, shape=ID)) +
labs(color='Naive+PP C5 Unique Pathways:', shape='Naive+PP C5 Unique Pathways:') +
#scale_color_manual(values=c(colors_fill[1], colors_fill[2])) +
scale_shape_manual(values=c(groupshapes[3], groupshapes[3])) +
scale_y_continuous(breaks=c(-7:-1,1:6), labels=SPP5NPP5_SPP5U_plot$Description) +
scale_x_continuous(breaks=c(-8, -6, -4, -2, 0, 2, 4, 6, 8), labels=abs(c(-8, -6, -4, -2, 0, 2, 4, 6, 8)), limits=c(-8,8)) +
ggtitle("Pathways Present in Unique Sens+PP-C5 Transcription") +
theme(axis.text.y = element_text(color = "black", size = 14.5))
SPP5NPP5_SPP5U_gg
View(SPP5NPP5_SharedUp_plot)
library(tidyverse)
library(ggplot2)
library(scales)
library(viridis)
library(cowplot)
colors_fill <- c("#38F2E0", "#1A74F8", "#F262F7", "#DA0054")
groupshapes <- c(19, 1, 15, 19, 1, 15, 17)
SPP5NPP5_SharedUp_gg2 <- ggplot(SPP5NPP5_SharedUp_plot, aes(x=Y, y=Sig, fill=Enrichment)) + ylab("Normalized Enrichment Score") + xlab("") + themeset
SPP5NPP5_SharedUp_gg2 <- SPP5NPP5_SharedUp_gg2 + geom_col(color="black") +
labs(color='Pathway Enrichment') +
#scale_fill_gradientn(colors=mako(n=100, begin=0.71, end=0.15), limits=c(0,1)) +
scale_fill_gradientn(colors=plasma(n=100, begin=0.8, end=0)) +
scale_x_continuous(breaks=c(1:9), labels=SPP5NPP5_SharedUp_plot$Description) +
scale_y_continuous(breaks=c(0, 3, 6, 9, 12), limits=c(0, 12)) +
ggtitle("Pathway Analysis of Shared Pregnancy Transcription")
SPP5NPP5_SharedUp_gg2 + coord_flip()
SPP5NPP5_SharedUp_gg2 <- ggplot(SPP5NPP5_SharedUp_plot, aes(x=Y, y=Sig, fill=Enrichment)) + ylab("Normalized Enrichment Score") + xlab("") + themeset
SPP5NPP5_SharedUp_gg2 <- SPP5NPP5_SharedUp_gg2 + geom_col(color="black") +
labs(color='Pathway Enrichment') +
#scale_fill_gradientn(colors=mako(n=100, begin=0.71, end=0.15), limits=c(0,1)) +
scale_fill_gradientn(colors=plasma(n=100, begin=0, end=0.8)) +
scale_x_continuous(breaks=c(1:9), labels=SPP5NPP5_SharedUp_plot$Description) +
scale_y_continuous(breaks=c(0, 3, 6, 9, 12), limits=c(0, 12)) +
ggtitle("Pathway Analysis of Shared Pregnancy Transcription")
SPP5NPP5_SharedUp_gg2 + coord_flip()
View(SPP5NPP5_SharedUp_plot)
library(tidyverse)
library(ggplot2)
library(scales)
library(viridis)
library(cowplot)
colors_fill <- c("#38F2E0", "#1A74F8", "#F262F7", "#DA0054")
groupshapes <- c(19, 1, 15, 19, 1, 15, 17)
SPP5NPP5_SharedUp_gg2 + coord_flip()
library(tidyverse)
library(ggplot2)
library(scales)
library(viridis)
library(cowplot)
colors_fill <- c("#38F2E0", "#1A74F8", "#F262F7", "#DA0054")
groupshapes <- c(19, 1, 15, 19, 1, 15, 17)
files_UD_Filtered <- list.files(path=filepath_UD, pattern="_F.csv")
files_Shared_Filtered <- list.files(path=filepath_Shared, pattern="_F.csv")
for(i in files_UD_Filtered){
objname <- str_replace(i, "_F.csv", "_Filtered")
dfin <- read.csv(str_c(filepath_UD, "/", i, sep=""), header=TRUE)
dfin <- dfin %>% mutate(Sig=1-LogP) %>% dplyr::select(Description, Sig, Enrichment) %>%  arrange(desc(Sig))
dfin$Description <- firstup(dfin$Description)
dfin <- dfin %>%  mutate(Y=rev(row_number()))
assign(objname, dfin, envir = .GlobalEnv)
rm(dfin)
rm(i)
}
files_UD_Filtered <- list.files(path=filepath_UD, pattern="_F.csv")
files_Shared_Filtered <- list.files(path=filepath_Shared, pattern="_F.csv")
for(i in files_UD_Filtered){
objname <- str_replace(i, "_F.csv", "_Filtered")
dfin <- read.csv(str_c(filepath_UD, "/", i, sep=""), header=TRUE)
dfin <- dfin %>% mutate(Sig=1-LogP) %>% dplyr::select(Description, Sig, Enrichment) %>%  arrange(desc(Sig))
dfin$Description <- firstup(dfin$Description)
dfin <- dfin %>%  mutate(Y=rev(row_number()))
assign(objname, dfin, envir = .GlobalEnv)
rm(dfin)
rm(i)
}
View(SPP7SUB_gg)
View(SPP7SPP5Up_Filtered)
SPP7SPP5_plot_Filtered <- bind_rows("Mem+PP C5"=SPP7SPP5Down, "Mem+PP C7"=SPP7SPP5Up, .id="ID")
SPP7SPP5_plot_Filtered$Sig <- if_else(SPP7SPP5_plot_Filtered$ID=="Mem+PP C5", (SPP7SPP5_plot_Filtered$Sig * -1), (SPP7SPP5_plot_Filtered$Sig * 1))
SPP7SPP5_plot_Filtered$Y <- if_else(SPP7SPP5_plot_Filtered$ID=="Mem+PP C5", (SPP7SPP5_plot_Filtered$Y * -1), (SPP7SPP5_plot_Filtered$Y * 1))
SPP7SPP5_plot_Filtered <- SPP7SPP5_plot_Filtered %>% arrange(Y)
SPP7SPP5_plot_Filtered_gg <- ggplot(SPP7SPP5_plot_Filtered, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
View(SPP7SPP5Down_Filtered)
View(SPP7SPP5Up_Filtered)
SPP7SPP5_plot_Filtered <- bind_rows("Mem+PP C5"=SPP7SPP5Down, "Mem+PP C7"=SPP7SPP5Up, .id="ID")
SPP7SPP5_plot_Filtered$Sig <- if_else(SPP7SPP5_plot_Filtered$ID=="Mem+PP C5", (SPP7SPP5_plot_Filtered$Sig * -1), (SPP7SPP5_plot_Filtered$Sig * 1))
SPP7SPP5_plot_Filtered$Y <- if_else(SPP7SPP5_plot_Filtered$ID=="Mem+PP C5", (SPP7SPP5_plot_Filtered$Y * -1), (SPP7SPP5_plot_Filtered$Y * 1))
SPP7SPP5_plot_Filtered <- SPP7SPP5_plot_Filtered %>% arrange(Y)
SPP7SPP5_plot_Filtered_gg <- ggplot(SPP7SPP5_plot_Filtered, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
SPP7SPP5_plot_Filtered_gg <- SPP7SPP5_plot_Filtered_gg + geom_point(aes(size=Enrichment, color=ID, shape=ID)) +
labs(color='Pathways Present In:', shape='Pathways Present In:') +
scale_color_manual(values=c(colors_fill[4], colors_fill[4])) +
scale_shape_manual(values=c(groupshapes[3], groupshapes[7])) +
scale_y_continuous(breaks=c(-3:-1,1:5), labels=SPP7SPP5_plot$Description) +
scale_x_continuous(trans=squish_trans(-3, 3, 6), breaks=c(-6:-3, 0, 3:6), labels=as.character(c(6:3, 0, 3:6)), limits=c(-6, 6)) +
ggtitle(str_c(as.character(tail(SPP7SPP5_plot$ID, n=1)), "Vs.", as.character(head(SPP7SPP5_plot$ID, n=1)), sep=" "))
SPP7SPP5_plot_Filtered_gg
View(SPP7SPP5Down_Filtered)
View(SPP7SPP5Up_Filtered)
SPP7SPP5_plot_Filtered <- bind_rows("Mem+PP C5"=SPP7SPP5Down, "Mem+PP C7"=SPP7SPP5Up, .id="ID")
SPP7SPP5_plot_Filtered$Sig <- if_else(SPP7SPP5_plot_Filtered$ID=="Mem+PP C5", (SPP7SPP5_plot_Filtered$Sig * -1), (SPP7SPP5_plot_Filtered$Sig * 1))
SPP7SPP5_plot_Filtered$Y <- if_else(SPP7SPP5_plot_Filtered$ID=="Mem+PP C5", (SPP7SPP5_plot_Filtered$Y * -1), (SPP7SPP5_plot_Filtered$Y * 1))
SPP7SPP5_plot_Filtered <- SPP7SPP5_plot_Filtered %>% arrange(Y)
SPP7SPP5_plot_Filtered_gg <- ggplot(SPP7SPP5_plot_Filtered, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
SPP7SPP5_plot_Filtered_gg <- SPP7SPP5_plot_Filtered_gg + geom_point(aes(size=Enrichment, color=ID, shape=ID)) +
labs(color='Pathways Present In:', shape='Pathways Present In:') +
scale_color_manual(values=c(colors_fill[4], colors_fill[4])) +
scale_shape_manual(values=c(groupshapes[3], groupshapes[7])) +
scale_y_continuous(breaks=c(-3:-1,1:5), labels=SPP7SPP5_plot_Filtered$Description) +
scale_x_continuous(trans=squish_trans(-3, 3, 6), breaks=c(-6:-3, 0, 3:6), labels=as.character(c(6:3, 0, 3:6)), limits=c(-6, 6)) +
ggtitle(str_c(as.character(tail(SPP7SPP5_plot_Filtered$ID, n=1)), "Vs.", as.character(head(SPP7SPP5_plot_Filtered$ID, n=1)), sep=" "))
SPP7SPP5_plot_Filtered_gg
SPP7SPP5_plot_Filtered <- bind_rows("Mem+PP C5"=SPP7SPP5Down_Filtered, "Mem+PP C7"=SPP7SPP5Up_Filtered, .id="ID")
SPP7SPP5_plot_Filtered$Sig <- if_else(SPP7SPP5_plot_Filtered$ID=="Mem+PP C5", (SPP7SPP5_plot_Filtered$Sig * -1), (SPP7SPP5_plot_Filtered$Sig * 1))
SPP7SPP5_plot_Filtered$Y <- if_else(SPP7SPP5_plot_Filtered$ID=="Mem+PP C5", (SPP7SPP5_plot_Filtered$Y * -1), (SPP7SPP5_plot_Filtered$Y * 1))
SPP7SPP5_plot_Filtered <- SPP7SPP5_plot_Filtered %>% arrange(Y)
SPP7SPP5_plot_Filtered_gg <- ggplot(SPP7SPP5_plot_Filtered, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
SPP7SPP5_plot_Filtered_gg <- SPP7SPP5_plot_Filtered_gg + geom_point(aes(size=Enrichment, color=ID, shape=ID)) +
labs(color='Pathways Present In:', shape='Pathways Present In:') +
scale_color_manual(values=c(colors_fill[4], colors_fill[4])) +
scale_shape_manual(values=c(groupshapes[3], groupshapes[7])) +
scale_y_continuous(breaks=c(-3:-1,1:5), labels=SPP7SPP5_plot_Filtered$Description) +
scale_x_continuous(trans=squish_trans(-3, 3, 6), breaks=c(-6:-3, 0, 3:6), labels=as.character(c(6:3, 0, 3:6)), limits=c(-6, 6)) +
ggtitle(str_c(as.character(tail(SPP7SPP5_plot_Filtered$ID, n=1)), "Vs.", as.character(head(SPP7SPP5_plot_Filtered$ID, n=1)), sep=" "))
SPP7SPP5_plot_Filtered_gg
SUBN_plot <- bind_rows("Naive"=SUBNDown, "Mem"=SUBNUp, .id="ID")
SUBN_plot$Sig <- if_else(SUBN_plot$ID=="Naive", (SUBN_plot$Sig * -1), (SUBN_plot$Sig * 1))
SUBN_plot$Y <- if_else(SUBN_plot$ID=="Naive", (SUBN_plot$Y * -1), (SUBN_plot$Y * 1))
SUBN_plot <- SUBN_plot %>% arrange(Y)
SUBN_gg <- ggplot(SUBN_plot, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
SUBN_gg <- SUBN_gg + geom_point(aes(size=Enrichment, color=ID, shape=ID)) +
labs(color='Pathways Present In:', shape='Pathways Present In:') +
#scale_color_manual(values=c(colors_fill[3], colors_fill[1])) +
#scale_shape_manual(values=c(groupshapes[1], groupshapes[1])) +
scale_y_continuous(breaks=c(-10:-1,1:10), labels=SUBN_plot$Description) +
scale_x_continuous(trans=squish_trans(-4, 4, 6), breaks=c(-15, -10, -5, -4, 0, 4, 5, 10, 15), labels=c(-15, -10, -5, "", 0, "", 5, 10, 15), limits=c(-10, 15.1)) +
ggtitle(str_c(as.character(tail(SUBN_plot$ID, n=1)), "Vs.", as.character(head(SUBN_plot$ID, n=1)), sep=" "))
SUBN_gg
SPP7SPP5_plot_Filtered <- bind_rows("Mem+PP C5"=SPP7SPP5Down_Filtered, "Mem+PP C7"=SPP7SPP5Up_Filtered, .id="ID")
SPP7SPP5_plot_Filtered$Sig <- if_else(SPP7SPP5_plot_Filtered$ID=="Mem+PP C5", (SPP7SPP5_plot_Filtered$Sig * -1), (SPP7SPP5_plot_Filtered$Sig * 1))
SPP7SPP5_plot_Filtered$Y <- if_else(SPP7SPP5_plot_Filtered$ID=="Mem+PP C5", (SPP7SPP5_plot_Filtered$Y * -1), (SPP7SPP5_plot_Filtered$Y * 1))
SPP7SPP5_plot_Filtered <- SPP7SPP5_plot_Filtered %>% arrange(Y)
SPP7SPP5_plot_Filtered_gg <- ggplot(SPP7SPP5_plot_Filtered, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
SPP7SPP5_plot_Filtered_gg <- SPP7SPP5_plot_Filtered_gg + geom_point(aes(size=Enrichment, color=ID)) +
labs(color='Pathways Present In:', shape='Pathways Present In:') +
scale_color_manual(values=c(colors_fill[4], colors_fill[4])) +
scale_shape_manual(values=c(groupshapes[3], groupshapes[7])) +
scale_y_continuous(breaks=c(-3:-1,1:5), labels=SPP7SPP5_plot_Filtered$Description) +
scale_x_continuous(trans=squish_trans(-3, 3, 6), breaks=c(-6:-3, 0, 3:6), labels=as.character(c(6:3, 0, 3:6)), limits=c(-6, 6)) +
ggtitle(str_c(as.character(tail(SPP7SPP5_plot_Filtered$ID, n=1)), "Vs.", as.character(head(SPP7SPP5_plot_Filtered$ID, n=1)), sep=" "))
SPP7SPP5_plot_Filtered_gg
SPP7SPP5_plot_Filtered <- bind_rows("Mem+PP C5"=SPP7SPP5Down_Filtered, "Mem+PP C7"=SPP7SPP5Up_Filtered, .id="ID")
SPP7SPP5_plot_Filtered$Sig <- if_else(SPP7SPP5_plot_Filtered$ID=="Mem+PP C5", (SPP7SPP5_plot_Filtered$Sig * -1), (SPP7SPP5_plot_Filtered$Sig * 1))
SPP7SPP5_plot_Filtered$Y <- if_else(SPP7SPP5_plot_Filtered$ID=="Mem+PP C5", (SPP7SPP5_plot_Filtered$Y * -1), (SPP7SPP5_plot_Filtered$Y * 1))
SPP7SPP5_plot_Filtered <- SPP7SPP5_plot_Filtered %>% arrange(Y)
SPP7SPP5_plot_Filtered_gg <- ggplot(SPP7SPP5_plot_Filtered, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
SPP7SPP5_plot_Filtered_gg <- SPP7SPP5_plot_Filtered_gg + geom_point(aes(size=Enrichment, color=ID)) +
labs(color='Pathways Present In:', shape='Pathways Present In:') +
#scale_color_manual(values=c(colors_fill[4], colors_fill[4])) +
#scale_shape_manual(values=c(groupshapes[3], groupshapes[7])) +
scale_y_continuous(breaks=c(-3:-1,1:5), labels=SPP7SPP5_plot_Filtered$Description) +
scale_x_continuous(trans=squish_trans(-3, 3, 6), breaks=c(-6:-3, 0, 3:6), labels=as.character(c(6:3, 0, 3:6)), limits=c(-6, 6)) +
ggtitle(str_c(as.character(tail(SPP7SPP5_plot_Filtered$ID, n=1)), "Vs.", as.character(head(SPP7SPP5_plot_Filtered$ID, n=1)), sep=" "))
SPP7SPP5_plot_Filtered_gg
View(SUBNDown_Filtered)
View(SUBNUp_Filtered)
SUBN_plot_Filtered <- bind_rows("Naive"=SUBNDown_Filtered, "Mem"=SUBNUp_Filtered, .id="ID")
SUBN_plot_Filtered$Sig <- if_else(SUBN_plot_Filtered$ID=="Naive", (SUBN_plot_Filtered$Sig * -1), (SUBN_plot_Filtered$Sig * 1))
SUBN_plot_Filtered$Y <- if_else(SUBN_plot_Filtered$ID=="Naive", (SUBN_plot_Filtered$Y * -1), (SUBN_plot_Filtered$Y * 1))
SUBN_plot_Filtered <- SUBN_plot_Filtered %>% arrange(Y)
SUBN_gg_Filtered <- ggplot(SUBN_plot_Filtered, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
SUBN_gg_Filtered <- SUBN_gg_Filtered + geom_point(aes(size=Enrichment, color=ID)) +
labs(color='Pathways Present In:', shape='Pathways Present In:') +
#scale_color_manual(values=c(colors_fill[3], colors_fill[1])) +
#scale_shape_manual(values=c(groupshapes[1], groupshapes[1])) +
scale_y_continuous(breaks=c(-10:-1,1:10), labels=SUBN_plot_Filtered$Description) +
scale_x_continuous(trans=squish_trans(-4, 4, 6), breaks=c(-15, -10, -5, -4, 0, 4, 5, 10, 15), labels=c(-15, -10, -5, "", 0, "", 5, 10, 15), limits=c(-10, 15.1)) +
ggtitle(str_c(as.character(tail(SUBN_plot_Filtered$ID, n=1)), "Vs.", as.character(head(SUBN_plot_Filtered$ID, n=1)), sep=" "))
SUBN_gg_Filtered
SUBN_plot_Filtered <- bind_rows("Naive"=SUBNDown_Filtered, "Mem"=SUBNUp_Filtered, .id="ID")
SUBN_plot_Filtered$Sig <- if_else(SUBN_plot_Filtered$ID=="Naive", (SUBN_plot_Filtered$Sig * -1), (SUBN_plot_Filtered$Sig * 1))
SUBN_plot_Filtered$Y <- if_else(SUBN_plot_Filtered$ID=="Naive", (SUBN_plot_Filtered$Y * -1), (SUBN_plot_Filtered$Y * 1))
SUBN_plot_Filtered <- SUBN_plot_Filtered %>% arrange(Y)
SUBN_gg_Filtered <- ggplot(SUBN_plot_Filtered, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
SUBN_gg_Filtered <- SUBN_gg_Filtered + geom_point(aes(size=Enrichment, color=ID)) +
labs(color='Pathways Present In:', shape='Pathways Present In:') +
#scale_color_manual(values=c(colors_fill[3], colors_fill[1])) +
#scale_shape_manual(values=c(groupshapes[1], groupshapes[1])) +
scale_y_continuous(breaks=c(-5:-1,1:6), labels=SUBN_plot_Filtered$Description) +
scale_x_continuous(trans=squish_trans(-4, 4, 6), breaks=c(-15, -10, -5, -4, 0, 4, 5, 10, 15), labels=c(-15, -10, -5, "", 0, "", 5, 10, 15), limits=c(-6.2, 15.1)) +
ggtitle(str_c(as.character(tail(SUBN_plot_Filtered$ID, n=1)), "Vs.", as.character(head(SUBN_plot_Filtered$ID, n=1)), sep=" "))
SUBN_gg_Filtered
SUBN_plot_Filtered <- bind_rows("Naive"=SUBNDown_Filtered, "Mem"=SUBNUp_Filtered, .id="ID")
SUBN_plot_Filtered$Sig <- if_else(SUBN_plot_Filtered$ID=="Naive", (SUBN_plot_Filtered$Sig * -1), (SUBN_plot_Filtered$Sig * 1))
SUBN_plot_Filtered$Y <- if_else(SUBN_plot_Filtered$ID=="Naive", (SUBN_plot_Filtered$Y * -1), (SUBN_plot_Filtered$Y * 1))
SUBN_plot_Filtered <- SUBN_plot_Filtered %>% arrange(Y)
SUBN_gg_Filtered <- ggplot(SUBN_plot_Filtered, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
SUBN_gg_Filtered <- SUBN_gg_Filtered + geom_point(aes(size=Enrichment, color=ID)) +
labs(color='Pathways Present In:', shape='Pathways Present In:') +
#scale_color_manual(values=c(colors_fill[3], colors_fill[1])) +
#scale_shape_manual(values=c(groupshapes[1], groupshapes[1])) +
scale_y_continuous(breaks=c(-5:-1,1:6), labels=SUBN_plot_Filtered$Description) +
scale_x_continuous(trans=squish_trans(-4, 4, 6), breaks=c(-15, -10, -5, -4, 0, 4, 5, 10, 15), labels=c(-15, -10, -5, "", 0, "", 5, 10, 15), limits=c(-15, 15.1)) +
ggtitle(str_c(as.character(tail(SUBN_plot_Filtered$ID, n=1)), "Vs.", as.character(head(SUBN_plot_Filtered$ID, n=1)), sep=" "))
SUBN_gg_Filtered
SUBN_plot_Filtered <- bind_rows("Naive"=SUBNDown_Filtered, "Mem"=SUBNUp_Filtered, .id="ID")
SUBN_plot_Filtered$Sig <- if_else(SUBN_plot_Filtered$ID=="Naive", (SUBN_plot_Filtered$Sig * -1), (SUBN_plot_Filtered$Sig * 1))
SUBN_plot_Filtered$Y <- if_else(SUBN_plot_Filtered$ID=="Naive", (SUBN_plot_Filtered$Y * -1), (SUBN_plot_Filtered$Y * 1))
SUBN_plot_Filtered <- SUBN_plot_Filtered %>% arrange(Y)
SUBN_gg_Filtered <- ggplot(SUBN_plot_Filtered, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
SUBN_gg_Filtered <- SUBN_gg_Filtered + geom_point(aes(size=Enrichment, color=ID)) +
labs(color='Pathways Present In:', shape='Pathways Present In:') +
#scale_color_manual(values=c(colors_fill[3], colors_fill[1])) +
#scale_shape_manual(values=c(groupshapes[1], groupshapes[1])) +
scale_y_continuous(breaks=c(-5:-1,1:6), labels=SUBN_plot_Filtered$Description) +
scale_x_continuous(breaks=c(-15, -10, -5, 0, 5, 10, 15), labels=c(-15, -10, -5, 0, 5, 10, 15), limits=c(-15, 15.1)) +
ggtitle(str_c(as.character(tail(SUBN_plot_Filtered$ID, n=1)), "Vs.", as.character(head(SUBN_plot_Filtered$ID, n=1)), sep=" "))
SUBN_gg_Filtered
SPP7SPP5_plot <- bind_rows("Mem+PP C5"=SPP7SPP5Down, "Mem+PP C7"=SPP7SPP5Up, .id="ID")
SPP7SPP5_plot$Sig <- if_else(SPP7SPP5_plot$ID=="Mem+PP C5", (SPP7SPP5_plot$Sig * -1), (SPP7SPP5_plot$Sig * 1))
SPP7SPP5_plot$Y <- if_else(SPP7SPP5_plot$ID=="Mem+PP C5", (SPP7SPP5_plot$Y * -1), (SPP7SPP5_plot$Y * 1))
SPP7SPP5_plot <- SPP7SPP5_plot %>% arrange(Y)
SPP7SPP5_gg <- ggplot(SPP7SPP5_plot, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
SPP7SPP5_gg <- SPP7SPP5_gg + geom_point(aes(size=Enrichment, color=ID, shape=ID)) +
labs(color='Pathways Present In:', shape='Pathways Present In:') +
scale_color_manual(values=c(colors_fill[4], colors_fill[4])) +
scale_shape_manual(values=c(groupshapes[3], groupshapes[7])) +
scale_y_continuous(breaks=c(-4:-1,1:10), labels=SPP7SPP5_plot$Description) +
scale_x_continuous(trans=squish_trans(-3, 3, 6), breaks=c(-7:-3, 0, 3:7), labels=as.character(c(7:3, 0, 3:7)), limits=c(-5, 6.2)) +
ggtitle(str_c(as.character(tail(SPP7SPP5_plot$ID, n=1)), "Vs.", as.character(head(SPP7SPP5_plot$ID, n=1)), sep=" "))
SPP7SPP5_gg
SPP7SPP5_plot_Filtered <- bind_rows("Mem+PP C5"=SPP7SPP5Down_Filtered, "Mem+PP C7"=SPP7SPP5Up_Filtered, .id="ID")
SPP7SPP5_plot_Filtered$Sig <- if_else(SPP7SPP5_plot_Filtered$ID=="Mem+PP C5", (SPP7SPP5_plot_Filtered$Sig * -1), (SPP7SPP5_plot_Filtered$Sig * 1))
SPP7SPP5_plot_Filtered$Y <- if_else(SPP7SPP5_plot_Filtered$ID=="Mem+PP C5", (SPP7SPP5_plot_Filtered$Y * -1), (SPP7SPP5_plot_Filtered$Y * 1))
SPP7SPP5_plot_Filtered <- SPP7SPP5_plot_Filtered %>% arrange(Y)
SPP7SPP5_plot_Filtered_gg <- ggplot(SPP7SPP5_plot_Filtered, aes(x=Sig, y=Y)) + xlab("-log(p-value)") + ylab("") + themeset
SPP7SPP5_plot_Filtered_gg <- SPP7SPP5_plot_Filtered_gg + geom_point(aes(size=Enrichment, color=ID)) +
labs(color='Pathways Present In:', shape='Pathways Present In:') +
#scale_color_manual(values=c(colors_fill[4], colors_fill[4])) +
#scale_shape_manual(values=c(groupshapes[3], groupshapes[7])) +
scale_y_continuous(breaks=c(-3:-1,1:5), labels=SPP7SPP5_plot_Filtered$Description) +
scale_x_continuous(trans=squish_trans(-3, 3, 6), breaks=c(-6:-3, 0, 3:6), labels=as.character(c(6:3, 0, 3:6)), limits=c(-6, 6)) +
ggtitle(str_c(as.character(tail(SPP7SPP5_plot_Filtered$ID, n=1)), "Vs.", as.character(head(SPP7SPP5_plot_Filtered$ID, n=1)), sep=" "))
SPP7SPP5_plot_Filtered_gg
